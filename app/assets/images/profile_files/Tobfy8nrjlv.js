/*!CK:1990832903!*//*1448469924,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["5PdVu"]); }

__d("TimelineFilterOptions",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ALL:"all",REVIEW:"review",TAG_REVIEW:"tagreview",FACE_ALERTS:"facealertsreview",POSTSANDAPPS:"postsandapps",LOCATION:"location",PHOTOS:"photos",TAGGED_PHOTOS:"taggedphotos",OWN_PHOTOS:"ownphotos",LIKES:"likes",LIKED_INTERESTS:"likedinterests",LIKED_POSTS:"likedposts",GROUPS:"groups",GROUP_MEMBERSHIP:"groupmembership",GROUP_POSTS:"groupposts",HIDDEN:"hidden",SPAM:"spam",ALL_APPS:"apps",SEARCH:"search",ADS:"ads",CLUSTER:"cluster",APP:"app",STORIES:"stories",COLLECTION_ITEM:"citem",FITNESS:"fitness",OG_VIDEO:"ogvideo",SAVED_FOR_LATER:"saved",PRIVATE_NOTES:"private_notes",NOW:"now"};},null);
__d('BrowseFacebarHighlighter',['CSS','csx','NodeHighlighter'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};Object.assign(k,j,{getHighlightCandidates:function(){return ["._53ad"];},isDiscardNode:function(l){return h.hasClass(l,'DefaultText');},createSegmentedRegex:function(l){l=this.escapeAndAddBidirectionalCharsToTokens(l);return '(^|\\s|\\b)('+l.join('|')+')';}});f.exports=k;},null);
__d('TypeaheadFacepileX.react',['React','joinClasses'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.createClass({displayName:'TypeaheadFacepile',renderPic:function(k,l){var m='url('+this.props.photos[k]+')';return (h.createElement('span',{className:i('splitpic',l),key:k,style:{backgroundImage:m}}));},renderPics:function(){var k=this.props.size;if(k>=3){return [this.renderPic(0,'leftpic'),this.renderPic(1,'toppic'),this.renderPic(2,'bottompic')];}else return [this.renderPic(0,'leftpic'),this.renderPic(1)];},render:function(){return (h.createElement('span',babelHelpers._extends({},this.props,{className:i(this.props.className,"splitpics clearfix")}),this.renderPics()));}});f.exports=j;},null);
__d('FacebarSemanticQuery',['CurrentUser','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='str',k=/\*[\w\-]+\(/g;function l(v){var w={me:h.getID()};return Object.assign(w,Array.isArray(v.semantic_map)?{}:v.semantic_map);}function m(v,w){var x=l(v);if(typeof x[w]!=='undefined')return String(x[w]);return w;}function n(v){return new i("/profile.php").addQueryData({id:v});}function o(v,w){var x=[w],y=[],z=v.browse_functions,aa=v.search_path;while(x.length>0){var ba=x.pop();if(!r(ba)){y.push(ba);continue;}var ca=ba.substring(0,ba.indexOf('(')),da=ca,ea=s(ba);if(!z[ca]){y=[];break;}var fa=z[ca].minNumParams,ga=z[ca].maxNumParams;if(x.length>0)if(z[ca].numParamsUnbounded){if(y.length>0)ca+='-'+ea.length;}else if(ea.length!=1&&ea.length>fa||ea.length===0&&fa!=ga)ca+='-'+ea.length;x.push(ca);for(var ha=0;ha<ea.length;ha++){if(ea[ha].length===0)continue;if(z[da].allowsFreeText){x.push(j+'/'+encodeURIComponent(encodeURIComponent(ea[ha])));}else x.push(ea[ha]);}}return new i(aa+y.join('/'));}function p(v){return v.replace(/['"\[\]]/g,'');}function q(v,w){var x=JSON.parse(w),y=[];if(x.length>0)y=[x[0]];var z=[],aa=v.browse_functions,ba=v.search_path;while(y.length>0){var ca=y.pop();if(typeof ca!=='object'){z.push(p(ca));continue;}var da=Object.keys(ca)[0],ea=da,fa=ca[da];if(!aa[da]){z=[];break;}var ga=aa[da].minNumParams,ha=aa[da].maxNumParams;if(y.length>0)if(aa[da].numParamsUnbounded){if(z.length>0)da+='-'+fa.length;}else if(fa.length!=1&&fa.length>ga||fa.length===0&&ga!=ha)da+='-'+fa.length;y.push(da);for(var ia=0;ia<fa.length;ia++){if(fa[ia].length===0)continue;if(aa[ea].allowsFreeText){y.push(j+'/'+encodeURIComponent(fa[ia]));}else y.push(fa[ia]);}}return new i(ba+z.join('/'));}function r(v){return (/^[a-z\-]+\(.*\)$/.test(v));}function s(v){if(!r(v)&&v.indexOf('param_')!==0)return [v];var w=v.substring(v.indexOf('(')+1,v.length-1);if(w.length===0)return [];return t(w);}function t(v){var w=[],x=0,y=0;for(var z=0;z<v.length;++z)if(v[z]==','&&y===0){w.push(v.substring(x,z));x=z+1;}else if(v[z]=='('){y++;}else if(v[z]==')')y--;w.push(v.substring(x,v.length));return w;}function u(v,w,x){'use strict';this.facebarConfig=v;this.unmapped=(w||"").trim();this.mapped=m(v,this.unmapped);this.position=null;this.$FacebarSemanticQuery1=typeof x!=='undefined'?x:false;}u.prototype.isEntity=function(){'use strict';return (/^\d+$/.test(this.mapped));};u.prototype.isShortcut=function(){'use strict';return this.mapped.indexOf('shortcut(')===0;};u.prototype.isImplemented=function(){'use strict';return this.mapped&&!this.mapped.match(k);};u.prototype.isSemanticForest=function(){'use strict';return this.$FacebarSemanticQuery1;};u.prototype.getUnimplemented=function(){'use strict';return (this.mapped.match(k)||[]).map(function(v){return v.substr(1,v.length-2);});};u.prototype.getURI=function(){'use strict';if(this.isEntity()){return n(this.mapped);}else if(this.isShortcut()){return new i(this.mapped.substr(9,this.mapped.length-10));}else if(this.isSemanticForest()){return q(this.facebarConfig,this.unmapped);}else return o(this.facebarConfig,this.unmapped);};f.exports=u;},null);
__d('FacebarURI',['FacebarJSConstants','FacebarSemanticQuery','KeywordsSearchResultConfig','URI','WWWBase'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={event:{ref:h.eventLinkRef},user:{fref:'ts'},page:{fref:'ts'}},n={getSearchRawPrefix:function(){return 'search';},getSearchPath:function(){return '/'+this.getSearchRawPrefix()+'/';},getURI:function(o,p){var q=null,r=!p.song&&!p.isExtendedResult&&p.path;if(r){q=new k(r);if(p.type in m)q.addQueryData(m[p.type]);}else if(j.use_seo_urls&&p.type===j.result_type&&p.semantic.startsWith('str/')){q=new k(j.seo_top_url).addQueryData('q',p.keyword?p.keyword:p.text);}else{var s=new i(o,p.semantic);if(s&&s.isImplemented())q=s.getURI();}return q&&n.getQualifiedURI(q);},getQualifiedURI:function(o){var p=new k(o);if(!p.getDomain()){var q=new k(l.uri);p.setProtocol(q.getProtocol()).setDomain(q.getDomain()).setPort(q.getPort());}return p;}};f.exports=n;},null);
__d('FacebarKeywordSearchUtils',['FacebarURI','FacebarStructuredText','KeywordsSearchResultConfig','URI'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(n){var o=0;while(o<n.length)if(n[o].exactMatchKeyword){n.splice(o,1);}else ++o;},m={addExactMatch:function(n,o,p){if(!o.length)return;var q,r;for(var s=0,t=o.length;s<t;s++){r=o[s];if(r.type==='grammar')continue;q=true;break;}if(!q)return;var u=this.getExactMatchKeywordResult(n);if(!u)return;var v=Math.min(o.length,p),w=v;for(s=0;s<v;s++){r=o[s];if(r.exactMatchKeyword)return;if(r.cost>j.default_cost)--w;if(r.type!==j.result_type)continue;u.backendCost=r.cost+j.exact_match_cost_delta_from_best;u.cost=r.backendCost;l(o);o.splice(s,0,u);return;}l(o);o.splice(Math.min(Math.min(v,p-1),w),0,u);},getExactMatchKeywordResult:function(n){if(!n||n.is_empty||!n.raw_text)return;var o=n.raw_text.toLowerCase().replace(/\s{2,}/g,' ').trim(),p=j.query_prefix_blacklist;for(var q=0;q<p.length;q++)if(o.startsWith(p[q]))return;var r=this.makeFacebarEntry(o);return this._makeFacebarResult(r,n.cache_id.length);},makeFacebarEntry:function(n){var o=null,p=null;if(j.gsv2_results_page){p='str/'+encodeURIComponent(n).replace(/%20/g,'+')+'/'+j.gsv2_browse_edge;o=h.getQualifiedURI(new k('/search/'+p));}else{o=h.getQualifiedURI(new k(j.results_page_url).addQueryData('q',n));p=j.shortcut+'('+o.toString()+')';}if(j.use_seo_urls)o=h.getQualifiedURI(new k(j.seo_top_url).addQueryData('q',n));return {semantic:p,text:n,type:j.result_type,resultsSetType:j.result_set_type,uid:j.uid_prefix+n,iconClass:j.icon_class,uri:o,structure:i.fromString(n)};},_makeFacebarResult:function(n,o){var p={semantic:n.semantic,structure:[{type:'grammar',text:n.text,uid:n.semantic}],type:n.type,resultsSetType:n.resultsSetType,cost:j.default_cost,cache_id_length:o,parse:{display:[{type:'grammar',uid:j.uid_prefix+n.text}],remTokens:[],suffix:''},iconClass:n.iconClass,exactMatchKeyword:true};p.tuid=JSON.stringify({semantic:p.semantic,structure:p.structure});return p;}};f.exports=m;},null);
__d('FacebarGSv2Echo',['FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText','FacebarURI','URI','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={insertInto:function(q,r,s,t){var u=p.normalizeValue(q);if(this._shouldInsert(q,r)){var v=r.findIndex((function(aa){return aa.isSpecialIntent&&this._isKeywordSuggestion(aa)&&u===p.normalizeValue(aa.text);}).bind(this),this),w=h.showEcho&&(!h.renderKeywordSnippets||v<0);if(w){var x=this._removeExactMatchAndReturnSubtext(q,r),y=this._createEchoResult(q,s,x,t);if(t){if(h.singleStateClientInjections){r.unshift(this._createSingleStateResult(o._("{fullName} videos",[o.param('fullName',u)]),{isVideos:true}));r.unshift(this._createSingleStateResult(o._("{fullName} photos",[o.param('fullName',u)]),{isPhotos:true}));}r.unshift(y);}else r.push(y);}if(h.findPostsSemantic){var z=r.findIndex(this._isKeywordSuggestion,this);if(z<0)z=r.length;r.splice(z,0,this._createFindPostsResult(q,s,t));}}},_shouldInsert:function(q,r){q=p.normalizeValue(q);if(!q||!h.graphSearchV2)return false;for(var s=0;s<r.length;s++){var t=r[s];if(q===p.normalizeValue(t.text))return false;}return true;},_isKeywordSuggestion:function(q){return q.type===i.keywordType||q.type===i.grammarType;},_removeExactMatchAndReturnSubtext:function(q,r){var s="";q=p.normalizeValue(q);for(var t=0;t<r.length;t++){var u=r[t];if(this._isKeywordSuggestion(u)&&q===p.normalizeValue(u.text)){if(u.subtext)s=u.subtext;r.splice(t,1);return s;}}return s;},normalizeValue:function(q){return String(q).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();},_createEchoResult:function(q,r,s,t){q=p.normalizeValue(q);var u=j.makeFacebarEntry(q);if(h.renderKeywordSnippets)s=s||o._("Search Facebook");return {type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_5b1w",isSingleState:t,exactMatchKeyword:true,structure:k.fromString(q),semantic:u.semantic,uri:u.uri,fromCache:r,subtext:s,tags:{}};},_createFindPostsResult:function(q,r,s){q=p.normalizeValue(q);var t=h.findPostsSemantic.replace('{QUERY}',q),u=h.findPostsSemantic.replace('{QUERY}',encodeURIComponent(q)),v=o._("Find all posts for \"{query}\"",[o.param('query',q)]);return {type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_4-vy",isSeeMore:true,isSingleState:s,structure:k.fromString(v),semantic:t,uri:l.getQualifiedURI(new m('/search/'+u)),fromCache:r,tags:{displayedSeeMore:true}};},_createSingleStateResult:function(q,r){var s=j.makeFacebarEntry(q),t=undefined;if(h.renderKeywordSnippets)t=o._("Search Facebook");return babelHelpers._extends({type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_5b1w",exactMatchKeyword:true,structure:k.fromString(q),semantic:s.semantic,uri:s.uri,subtext:t,tags:{}},r);}};f.exports=p;},null);
__d('FacebarNoFlickerResults',['FacebarGSv2Echo','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=[],p={},q={insertInto:function(r,s,t,u){s.forEach(function(ga){ga.isInvalidated=false;});r=h.normalizeValue(r);var v=r.length===0,w=s.filter(function(ga){return ga.type===j.keywordType&&!ga.exactMatchKeyword;}),x=w.filter(function(ga){return !ga.exactMatchKeyword;}),y=w.length;if(x.length>1)if(v){o=[];}else o=x.slice(0,2);if(p[r]||t===true&&u||!i.graphSearchV2||!i.renderKeywordsFirst||y>=i.default_num_top_results_to_show){p[r]=true;if(v){o=[];}else o=x.slice(0,2);return;}if(!u)return;var z=function(){if(ba){if(ca>=aa.length)return 'break';da=aa[ca++];}else{ca=aa.next();if(ca.done)return 'break';da=ca.value;}var ga=da;if(!s.some(function(ha){return ha.text===ga.text;})){ga.isInvalidated=true;s.push(ga);}};for(var aa=o,ba=Array.isArray(aa),ca=0,aa=ba?aa:aa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var da,ea=z();if(ea==='break')break;}var fa=s.filter(function(ga){return ga.type==='user';})[0];if(fa==null)return;s.push(this._createResult(n._("{fullName} photos",[n.param('fullName',fa.text.toLowerCase())])));s.push(this._createResult(n._("{fullName} posts",[n.param('fullName',fa.text.toLowerCase())])));},_createResult:function(r){var s=k.makeFacebarEntry(String(r)),t=undefined;if(i.renderKeywordSnippets)t=n._("Search Facebook");return {type:j.keywordType,results_set_type:j.browseTypes.keyword,text:r,id:r,uid:r,query_string:r,icon_class:"_5b1w",exactMatchKeyword:true,structure:l.fromString(String(r)),semantic:s.semantic,uri:s.uri,subtext:t,isInvalidated:true,tags:{}};}};f.exports=q;},null);
__d('FacebarResultStore',['FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','KeywordsSearchResultConfig','TokenizeUtil','SearchI18nMatch','concatMap','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();function r(s,t,u,v){'use strict';this.facebarConfig=s;this.facebarConfig.grammar_stop_words_penalty=this.facebarConfig.grammar_stop_words_penalty||2;this.facebarConfig.grammar_stop_words=this.facebarConfig.grammar_stop_words||{};this.facebarConfig.options=v;this.tokenize=t;this.getEntry=u;this.typeaheadTypeMap=this.facebarConfig.mapped_types;this.facebarConfig.typeahead_types.forEach(function(w){this.typeaheadTypeMap[w]=w;},this);this.unicodeMatch=new o({prefix_hangul_conjoining_jamo:true});this.resetCaches();}r.prototype.transformStructured=function(s){'use strict';var t=[],u=[],v='',w='';s.forEach(function(z,aa){if(z.isType('text')){v+=z.getText();w=w==null?null:w+z.getText();}else{var ba=v.match(/\"/g);if(ba&&ba.length%2)v=v.replace(/\s+$/,'')+'"';if(v.length){Array.prototype.push.apply(t,this.tokenize(v));u.push(v);v='';}t.push(z.toStruct());u.push({uid:String(z.getUID()),type:this._getFBObjectType(z.getTypePart(1)),text:z.getText()});w=null;}},this);if(v.length){if(v[v.length-1]=='\'')v=v.substr(0,v.length-1);Array.prototype.push.apply(t,this.tokenize(v));u.push(v);if(v[v.length-1]==' ')t.push('');}var x=JSON.stringify(u),y=x.replace(/\]$/,'').replace(/\"$/,'');y=y.replace(/\s{2,}/g,' ');return {tokens:t,text_form:x,is_empty:!!x.match(/^\[(\"\s*\")?\]$/),raw_text:w,cache_id:y};};r.prototype.resetCaches=function(){'use strict';this.resetBootstrapCache();this.resetQueryCache();};r.prototype.resetBootstrapCache=function(){'use strict';this.bootstrapCache={};};r.prototype.resetQueryCache=function(){'use strict';this.queryCache={'':{tokens:[],results:[]}};};r.prototype.setNullState=function(s){'use strict';this.facebarConfig.null_state=s.map(this._extractStructure,this);};r.prototype.addEntryToNullState=function(s){'use strict';if(this.facebarConfig.null_state){var t=this.facebarConfig.entity_cost+s.grammar_costs['{'+s.type+'}'],u=k.processEntityResult(s.type,s.uid,s.text,t);this.facebarConfig.null_state.unshift(u);}};r.prototype.addRecentEntryToNullState=function(s){'use strict';if(!this.facebarConfig.null_state)return;var t=decodeURIComponent(s.semantic);for(var u=0;u<this.facebarConfig.null_state.length;u++){var v=this.facebarConfig.null_state[u];if(v.semantic===t){this.facebarConfig.null_state.splice(u,1);break;}}var w=babelHelpers._extends({},s,{isRecent:true,isNullState:true,type:i.keywordType,structure:l.fromString(s.text),tuid:JSON.stringify({semantic:s.semantic,structure:s.structure})});if(s.icon_class)w.iconClass=s.icon_class;if(s.keywordBootstrapType===i.keywordBootstrapTypes.recent){w.iconClass="_5b1w";delete w.keywordBootstrapType;}if(s.results_set_type)w.resultsSetType=s.results_set_type;var x=this.facebarConfig.null_state.findIndex(function(y){return y.isRecent;});if(x<0){if(h.hasRecentOnTopNullState){this.facebarConfig.null_state.unshift(w);}else{if(this.facebarConfig.null_state.length>=h.maxResultCount)this.facebarConfig.null_state.shift();this.facebarConfig.null_state.push(w);}return;}this.facebarConfig.null_state.splice(x,0,w);};r.prototype.clearRecentSearches=function(){'use strict';if(!this.facebarConfig.null_state)return;this.facebarConfig.null_state=this.facebarConfig.null_state.filter(function(s){return !s.isRecent;});};r.prototype.setSortFunction=function(s){'use strict';this._sortFunction=s;};r.prototype.addBootstrap=function(s){'use strict';var t=this.bootstrapCache;s.forEach(function(u){var v=this.getEntry(u);v.bootstrapped=true;var w=this.tokenize(v.textToIndex,true);if(v.tokens)Array.prototype.push.apply(w,v.tokens.split(' '));Array.prototype.push.apply(w,this.getExtraTokensToIndex(v));w.forEach(function(x){if(!t.hasOwnProperty(x))t[x]={};t[x][u]=true;});},this);};r.prototype.getExtraTokensToIndex=function(s){'use strict';var t=[];if(s.alias!=null)t.push(s.alias.toLowerCase());return t;};r.prototype.addNullStateToQueryCache=function(s,t){'use strict';this.saveResults(this.facebarConfig.null_state,s,true);if(h.includeInitialTypeNamedX)this.saveResults(t,s,true);};r.prototype.extendResult=function(s,t){'use strict';var u=s.cache_id.substr(t.cache_id_length);if((u.indexOf("\"")>=0||t.tokens.length===0)&&!t.isTypeNamedXBootstrap)return null;var v;if(!!t.isTypeNamedXBootstrap){if(s.raw_text!==null){v=t.ext_text+u;}else if(s.tokens.length!==0&&s.tokens[0].text){v=s.tokens[0].text;}else return null;}else if(t.tokens[t.tokens.length-1].length!==0){v=t.ext_text+u;}else v=t.ext_text+" "+u;if(v.length===0)return null;t.ext_node.text=v;t.parse.entTokens=[v];t.parse.suffix="";this._extractStructure(t);if(!this._punctRegexp)this._punctRegexp=new RegExp(n.getPunctuation(),'g');t.semantic=t.ext_semantic.replace('(ext_string)','('+v.replace(this._punctRegexp,"")+')');t.isExtendedResult=true;return t;};r.prototype.getResults=function(s,t){'use strict';if(s.tokens.length===0||s.tokens.length==1&&s.tokens[0]==='')return {results:this.facebarConfig.null_state||[],null_state:true};var u=this._getBestQueryCache(s.cache_id),v=u.results.filter(function(na){return !na.isRecent;}),w={},x=this._getBootstrapMatchByType(s.tokens,w),y=this._addMatchingBootstrapResults(s,x[0]||{},w);if(h.limitBootstrapResult)y=y.slice(0,h.limitBootstrapResultNum);var z=[],aa=[];if(h.hasKeywordBootstrap){z=y.filter(function(na){return na.type===i.keywordType;});var ba=y.filter(function(na){return na.keywordBootstrapType===i.keywordBootstrapTypes.recent;});if(h.onlyPrefixMatching)ba=ba.filter(function(na){return this.unicodeMatch.prefixMatch(na.structure[0].text,s.tokens[0]);},this);ba.sort(function(na,oa){return na.structure[0].text.length-oa.structure[0].text.length;});var ca=y.filter(function(na){return na.keywordBootstrapType===i.keywordBootstrapTypes.trending;});ca.sort(function(na,oa){return na.structure[0].text.length-oa.structure[0].text.length;});var da=[];for(var ea=0;ea<ca.length;ea++){var fa=ca[ea].trendingTopicID;if(!fa)continue;if(da[fa]){ca.splice(ea--,1);}else da[fa]=fa;}var ga=y.filter(function(na){return na.keywordBootstrapType===i.keywordBootstrapTypes.serp_first&&this.unicodeMatch.prefixMatch(na.structure[0].text,s.tokens[0]);},this),ha=y.filter(function(na){return na.keywordBootstrapType===i.keywordBootstrapTypes.popular&&this.unicodeMatch.prefixMatch(na.structure[0].text,s.tokens[0]);},this),ia=ha.concat(ga);ia.sort(function(na,oa){oa.popularSearchScore-na.popularSearchScore;});z=ba.concat(ca).concat(ia);aa=y.filter(function(na){return na.type!==i.keywordType;});aa.sort(this._sortFunction);y=aa.concat(z);}Array.prototype.push.apply(y,p(this._getResultsFromCache.bind(this,x,s),v));if(!h.hasKeywordBootstrap){y.sort(this._sortFunction);if(!h.graphSearchV2&&h.keywordSearchEnabled)j.addExactMatch(s,y,t);}var ja={},ka=[],la=false,ma=0;y.forEach(function(na){var oa=l.fromStruct(na.structure);if(oa.hasType('blank')){ka.push(na);return;}na.semantic=na.semantic.toLowerCase();if(!na.termMatches)na.termMatches=w[na.semantic];var pa=r.getUniqueSemantic(na.semantic),qa=r.getUniqueSemantic(na.alternateSemantic);if(!pa)return;var ra=ja[pa]||qa&&ja[qa];if(ra){if(na.isJSBootstrapMatch){ra.isJSBootstrapMatch=true;ra.bootstrapCost=na.bootstrapCost;}else if(ra.isJSBootstrapMatch&&na.backendCost!==undefined&&ra.backendCost===undefined)ra.backendCost=na.backendCost;if(!!na.tags)Object.assign(ra.tags||{},na.tags);return;}if(la&&na.blankFilled)return;if(na.type.indexOf('browse_type')>=0){ma+=1;if(this.facebarConfig.maxGrammarResults!==undefined&&ma>this.facebarConfig.maxGrammarResults)return;}la=la||!!na.blankFilled;ja[pa]=na;if(qa)ja[qa]=na;ka.push(na);},this);return {results:ka};};r.prototype.saveResults=function(s,t,u,v,w){'use strict';s=s.map(this._processBackendResult,this);var x=[],y={},z={};s.forEach(function(ba){z[ba.semantic]=true;});var aa=this._getBestQueryCache(t.cache_id);aa.results.forEach(function(ba){if(ba.type==='websuggestion')return;if(ba.exactMatchKeyword)return;if(ba.isExtendedResult)return;if(ba.semantic in y)return;var ca=this._getDifferenceArrayTokens(ba.tokens,t.tokens),da=this._getNumTokensMatching(ca,ba);da=this._tryMatchingFinalInsertedEntity(ca,da,ba);if(da>0&&da==ca.length||(ba.type==="shortcut"&&ba.termMatches.indexOf(t.tokens[t.tokens.length-1]))>=0){ba.cacheOnlyResult=!z[ba.semantic];x.push(ba);}},this);if(h.limitCacheResult)x=x.slice(0,h.limitCacheResultNum);s.forEach(function(ba){ba.tokens=t.tokens;ba.cache_id_length=t.cache_id.length;if(!!ba.isTypeNamedXBootstrap)++ba.cache_id_length;x.push(ba);},this);if(w)Array.prototype.push.apply(x,w);if(this.queryCache[t.cache_id]===undefined)this.queryCache[t.cache_id]={};Object.assign(this.queryCache[t.cache_id],{tokens:t.tokens,results:x,incomplete:u},v);};r.prototype.alreadyKnown=function(s){'use strict';return !!this.queryCache[s]&&!this.queryCache[s].incomplete;};r.prototype.stripBrackets=function(s){'use strict';return s.replace(/^[\[\{]/,'').replace(/[\]\}]$/,'');};r.prototype._extractStructure=function(s){'use strict';function t(w,x,y){return {type:w==='ent:extend_string'?'text':w,text:x,uid:y||null};}function u(w,x){w.split(' ').forEach(function(y){if(y!==''){if(x)s.chunks.push(s.structure.length);s.structure.push(t('text',y));}s.structure.push(t('text',' '));});s.structure.pop();}function v(w){if(s.structure.length!==0||i.nonGrammarTypes[s.type])return w;return w.charAt(0).toUpperCase()+w.substr(1);}s.structure=[];s.chunks=[];s.parse.display.forEach(function(w){if(typeof w==='string'){u(v(w),true);}else if(w.type==='ent:extend_string'){u(w.text,true);}else if(w.uid){var x=this.getEntry(w.uid,w.fetchType);s.chunks.push(s.structure.length);if(x==null)throw new Error('No entry found for uid \"'+w.uid+'\", type \"'+w.fetchType+'\" and piece text \"'+w.text+'\"');if(x.grammar_like){u(v(x.text),false);}else{var y=w.type;if(w.fetchType)y+=':'+w.fetchType;s.structure.push(t(y,x.text,w.uid));}}else if(w.type=='blank'){s.chunks.push(s.structure.length);s.structure.push(t(w.type,'...'));}},this);return s;};r.prototype._getDifferenceArrayTokens=function(s,t){'use strict';if(!s.length)return [''].concat(t);var u=s.length-1,v=s[u];if(v==='')v=s[--u];var w='';if(typeof v=='string'&&u<t.length)w=t[u].substr(v.length);if(w===''&&u+1<t.length&&t[u+1]==='')return [''];return [w].concat(t.slice(u+1));};r.prototype._processBackendResult=function(s){'use strict';if(s.isTypeNamedXBootstrap&&s.cache_id_length)return s;s.semantic=s.semantic.toString();s.backendCost=s.cost;this._extractStructure(s);if(s.type.match(/^\{.*\}$/))s.useExtendedIndex=true;if(s.alternateSemantic)s.alternateSemantic=s.alternateSemantic.toLowerCase().replace(/\[(\d*)\]/g,'$1');if(s.parse.extendable){var t=null;s.parse.display.forEach(function(z){if(z.type!=="ent:extend_string")return;t=z;},this);if(!t||s.semantic.match(/\[.*\]/).length!==1){s.parse.extendable=false;}else{s.ext_node=t;s.ext_semantic=s.semantic.replace(/\[(.*)\]/g,'ext_string');s.ext_text=t.text;}}if(s.semantic.match(/\[\d*\]/)){var u=s.parse,v=u.pos;if(v===undefined){s.semantic=s.semantic.replace(/\[(\d*)\]/g,'$1');}else{var w=u.remTokens[u.remTokens.length-1];if(u.remTokens.length&&s.structure[s.chunks[w]]&&s.structure[s.chunks[w]].uid){v=u.remTokens[u.remTokens.length-1];s.completed=true;}var x=s.structure[s.chunks[v]].uid;if(x===null){s.semantic=s.semantic.replace(/\[(\d*)\]/g,'$1');}else{var y=new RegExp('\\['+x+'\\]','g');s.unsubstituted_semantic=s.semantic;s.semantic=s.semantic.replace(y,x);if(u&&u.disambiguation&&u.disambiguation.length>0){u.disambiguation=u.disambiguation.filter(function(z){return z.indexOf('['+x+']')!==-1;});u.unsubstituted_disambiguation=u.disambiguation.splice(0);u.disambiguation=u.disambiguation.map(function(z){return z.replace(y,x);});}}}}s.semantic=s.semantic.replace(/\[(.*)\]/g,'$1');s.tuid=JSON.stringify({semantic:s.semantic,structure:s.structure});return s;};r.prototype._sortFunction=function(s,t){'use strict';return (s.cost||0)-(t.cost||0);};r.prototype._getResultsFromCache=function(s,t,u){'use strict';var v=t.tokens,w=this._getDifferenceArrayTokens(u.tokens,v),x=[],y=this._getNumTokensMatching(w,u),z=this._tryMatchingFinalInsertedEntity(w,y,u);if(u.parse.extendable||u.isExtendedResult){var aa=this.extendResult(t,u);if(aa)x.push(aa);if(u.isExtendedResult)return x;}if(z>0&&z==w.length&&!(u.type===m.result_type&&w.length===1&&w[0]==='"'))x.push(u);if(u.type==="shortcut"&&u.termMatches.indexOf(t.tokens[v-1])>=0)x.push(u);return x;};r.prototype._addMatchingBootstrapResults=function(s,t,u){'use strict';var v=s.tokens;return p((function(w){var x=t[w];if(x===undefined)return [];var y=[],z=k.getQueryFeatures(s);x.forEach(function(aa){var ba=this.getEntry(aa,w);if(!this._isTitleTermMatch(v,ba)&&!this._isAliasMatch(s.raw_text,ba))return;var ca=this._isExactNameMatch(v,ba)||this._isAliasMatch(s.raw_text,ba),da=ca?0:this.facebarConfig.non_title_term_match_penalty,ea=this._isNonGrammarTermMatch(v,ba),fa=ba.grammar_costs?ba.grammar_costs['{'+w+'}']:0,ga=fa+da+this.facebarConfig.entity_cost+this.facebarConfig.grammar_stop_words_penalty*!ea,ha=k.processEntityResult(w,aa,ba.text,ga,s,z,u,ca,!ea);ha.bootstrapCost=ga;ha.isJSBootstrapMatch=true;if(w===i.keywordType){ha.iconClass=ba.iconClass;ha.keywordBootstrapType=ba.keywordBootstrapType;ha.parse=ba.parse;ha.subtext=ba.subtext;ha.boldedSubtext=ba.boldedSubtext;ha.semantic=ba.semantic;ha.popularSearchScore=ba.popularSearchScore;ha.trendingTopicID=ba.trendingTopicID;ha.photo=ba.photo;}y.push(ha);},this);return y;}).bind(this),this.facebarConfig.bootstrap_types);};r.prototype._isTitleTermMatch=function(s,t){'use strict';var u=s[0]||{};if(typeof u=='object')return false;var v=t.titleToIndex;return s.length===1?this._isTokenizePrefixMatch(u,v):n.isExactMatch(u,v);};r.prototype._isExactNameMatch=function(s,t){'use strict';var u=s[0]||{};if(typeof u=='object')return false;var v=t.text;for(var w=0;w<s.length-1;++w)if(s[w]!==''&&!n.isExactMatch(s[w],v))return false;return s.length>0&&this._isTokenizePrefixMatch(s[s.length-1],v);};r.prototype._isAliasMatch=function(s,t){'use strict';return t.alias!=null&&s!=null&&n.isExactMatch(t.alias,s);};r.prototype._isNonGrammarTermMatch=function(s,t){'use strict';var u=n.parse(t.titleToIndex.toLowerCase()),v=u.tokens.filter(function(y){return y!==''&&!this.facebarConfig.grammar_stop_words[y];},this);v=v.join(' ');for(var w=0;w<s.length;++w){if(typeof s[w]=='object')return true;var x=w===s.length-1?this._isTokenizePrefixMatch(s[w],v):n.isQueryMatch(s[w],v);if(x)return true;}return false;};r.prototype._getBootstrapMatchByType=function(s,t){'use strict';if(s.length===0)return [];var u=s.map(function(){return {};}),v=s[s.length-1]==='',w={},x,y=v?s.length-1:s.length,z=s[y-1];if(y&&z.uid){this._pushBootstrapEntryAtPosition(u,y-1,z.uid);return u;}for(var aa in this.bootstrapCache)if(y&&this.unicodeMatch.prefixMatch(aa,z)&&(!v||aa===z))for(x in this.bootstrapCache[aa])if(!w[x]){w[x]=1;this._addMatchedTerm(x,aa,t);this._pushBootstrapEntryAtPosition(u,y-1,x);}for(var ba=y-2;ba>=0;ba--){if(typeof s[ba]=='object')break;if(s[ba].length&&s[ba][0]=='"')break;for(x in this.bootstrapCache[s[ba]]){if(!w[x])w[x]=0;if(w[x]+ba==y-1){++w[x];this._addMatchedTerm(x,s[ba],t);this._pushBootstrapEntryAtPosition(u,ba,x);}}}return u;};r.prototype._addMatchedTerm=function(s,t,u){'use strict';(u[s]=u[s]||[]).push(t);return u;};r.prototype._pushBootstrapEntryAtPosition=function(s,t,u){'use strict';var v=this.getEntry(u);if(!v)return;var w=[];if(v.grammar_costs){w=Object.keys(v.grammar_costs).map(function(z){return this.stripBrackets(z);},this);}else w=[v.type];for(var x=0;x<w.length;x++){var y=w[x];if(s[t][y]===undefined)s[t][y]=[];s[t][y].push(u);}};r.prototype._getNumTokensMatching=function(s,t){'use strict';var u=0,v=t.parse,w=s.length,x=null,y=null;if(v.pos!==undefined){var z=t.structure[t.chunks[v.pos]];if(z){x=z.uid;y=z.type.split(':')[2];}}t.outputTokensUsed=[];t.termMatches=[];if(x){u=this._prefixMatchEntity(s,v,x,t.outputTokensUsed,y,!!t.useExtendedIndex,t.termMatches);if(u===0||u===w)return u;}else if(v.suffix&&w==1&&v.suffix.indexOf(s[0])===0){return w;}else if(v.suffix==s[0]){++u;}else return 0;var aa=[];v.remTokens=v.remTokens||[];for(var ba=0;ba<v.remTokens.length;ba++){if(typeof s[u]!='string'||t.chunks.length<=v.remTokens[ba]||t.structure.length<=t.chunks[v.remTokens[ba]]||t.structure[t.chunks[v.remTokens[ba]]].uid)break;var ca=t.structure[t.chunks[v.remTokens[ba]]].text;aa.push(ca.toLowerCase());}u=this._greedyMatchText(aa,s,u,v.remTokens,t.outputTokensUsed,t.isNullState);if(u==w-1&&s[u]==='')return w;return u;};r.prototype._prefixMatchEntity=function(s,t,u,v,w,x,y){'use strict';t.entTokens=t.entTokens||[];if(t.entTokens.length===0){if(s[0]!=='')return 0;if(t.possessive&&s.length>1&&s[1]=='\'s'){v.push([t.pos+1]);return 2;}else return 1;}var z=false,aa=this.getEntry(u,w);if(typeof w!=='undefined'&&w!==aa.fetchType)return 0;var ba=this.tokenize(x?aa.textToIndex:aa.text,true),ca=[];for(var da=0;da<s.length+t.entTokens.length-1;da++)if(da<t.entTokens.length-1){ca.push(t.entTokens[da]);}else if(da==t.entTokens.length-1){ca.push(t.entTokens[da]+s[0]);}else ca.push(s[da-t.entTokens.length+1]);var ea=-t.entTokens.length+1;for(var fa=0;fa<ca.length;++fa){var ga=ca[fa];if(typeof ga!='string')break;if(ga===''){ea++;continue;}var ha=false;for(var ia=0;ia<ba.length;ia++)if(ba[ia]==ga||fa===ca.length-1&&ba[ia].indexOf(ga)===0){if(y)y.push(ba[ia]);ba[ia]='';ha=true;++ea;break;}if(ha)continue;if(!t.possessive||ga.length<=2||ga.substr(ga.length-2)!='\'s')break;var ja=ga.substr(0,ga.length-2);for(ia=0;ia<ba.length;ia++)if(ba[ia]==ja){++ea;if(v)z=true;break;}break;}if(ea>0){if(z)v.push([t.pos+1]);return ea;}if(v===undefined)return 0;var ka=s[0],la=ka;if(t.possessive&&ka.length>=2&&ka.substr(ka.length-2)=='\'s')la=ka.substr(0,ka.length-2);t.suffix=t.suffix||'';if(s.length==1&&t.suffix.indexOf(ka)===0||t.suffix==la||t.suffix==ka){if(la!=ka&&t.suffix==la)v.push([t.pos+1]);return 1;}return 0;};r.prototype._tryMatchingFinalInsertedEntity=function(s,t,u){'use strict';if(!u.completed||t<0)return t;var v=u.parse,w=v.remTokens[v.remTokens.length-1],x=u.structure[u.chunks[w]],y=this.getEntry(x.uid,x.type),z=this.tokenize(y.text,true);t=this._greedyMatchText(z,s,t);if(t==s.length-1&&s[t]==='')return s.length;return t;};r.prototype._greedyMatchText=function(s,t,u,v,w,x){'use strict';for(var y=0;y<s.length;y++){var z=s[y];if(z==t[u]){if(w!==undefined)w.push(v[y]);++u;continue;}if(u===t.length-1&&z.indexOf(t[u])===0){if(w!==undefined)if(z==t[u]){w.push([v[y]]);}else w.push([v[y],t[u].length]);return t.length;}if(x)break;}return u;};r.prototype._getBestQueryCache=function(s){'use strict';for(var t=s.length;t>=0;t--){var u=this.queryCache[s.slice(0,t)];if(u)return u;}};r.prototype._getFBObjectType=function(s){'use strict';if(this.typeaheadTypeMap[s]){return this.typeaheadTypeMap[s];}else return 'page';};r.prototype._isTokenizePrefixMatch=function(s,t){'use strict';return n.isPrefixMatch(this.unicodeMatch.prefixMatchPrepare(s),this.unicodeMatch.prefixMatchPrepare(t));};r.EPSILON=1e-05;r.getUniqueSemantic=function(s){if(!s)return;var t=[],u=[],v=[];s='('+s+')';var w=s,x=false;s.replace(/[\(\),]/g,function(y,z){var aa;switch(y){case ',':var ba=v.length-1;aa=w.substr(v[ba],z-v[ba]);t[ba].push(aa);v[ba]=z+1;break;case '(':v.push(z+1);t.push([]);u.push(z+1);break;case ')':if(v.length===0)throw s+' is not a valid semantic string';var ca=v.pop();aa=w.substr(ca,z-ca);aa=decodeURI(aa.replace(/%/g,'%25').replace(/\s/g,'+').trim());var da=t.pop();da.push(aa);var ea=da.sort();for(var fa=1;fa<ea.length;fa++)if(ea[fa]==ea[fa-1])x=true;var ga=ea.join(',');w=w.substr(0,u.pop())+ga+w.substr(z);break;}return y;});if(x)return '';return w.replace(/\((.*)\)/,'$1');};f.exports=r;},null);
__d("FacebarTokenizer",["TokenizeUtil"],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i="[^\"]",j=["\\s's","'s","\""+i+"*\"?"],k=[[/\s+$/,''],[/\"\s+/,'"'],[/\s+\"/,'"'],[/\"\"/,''],[/^\"$/,''],[/\s+/,' ']],l={tokenize:function(m,n){var o=[],p=0;m=m.replace(/\s/g,' ').toLowerCase();m.replace(new RegExp(j.join('|'),'g'),function(r,s){if(s>p){var t=m.substr(p,s-p);Array.prototype.push.apply(o,h.parse(t).tokens.slice(0));}var u=r;for(var v=0;v<k.length;v++){var w=k[v];u=u.replace(w[0],w[1]);}if(o.length&&u=='\'s'){o[o.length-1]+=u;}else if(u!=='')o.push(u);if(n)Array.prototype.push.apply(o,h.parse(r).tokens);p=s+r.length;});if(p<m.length){var q=m.substr(p,m.length-p);Array.prototype.push.apply(o,h.parse(q).tokens.slice(0));}return o;}};f.exports=l;},null);
__d('ResultsBucketizer',['FacebarJSConstants','FacebarGlobalOptions'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l){'use strict';this.$ResultsBucketizer1=k;this.$ResultsBucketizer2=l;}j.trimResults=function(k,l,m){'use strict';var n=[];k.forEach(function(o,p){if(o.indexBeforeBuckets>l)n.push({index:p,originalIndex:o.indexBeforeBuckets});});n.sort(function(o,p){return o.originalIndex-p.originalIndex;}).slice(m).sort(function(o,p){return p.index-o.index;}).forEach(function(o){k.splice(o.index,1);});};j.mergeBuckets=function(k,l){'use strict';var m=[];for(var n in l)if(!l[n].rule.hidden&&(!l[n].rule.xor||!l[l[n].rule.xor]))m.push(l[n]);m.sort(function(o,p){var q=(o.rule.position||0)-(p.rule.position||0);if(q!==0)return q;return o.results[0].indexBeforeBuckets-p.results[0].indexBeforeBuckets;});k.length=0;m.forEach((function(o,p){if(o.rule.maxPromotions!=null&&p<m.length-1)j.trimResults(o.results,m[p+1].results[0].indexBeforeBuckets,o.rule.maxPromotions);Array.prototype.push.apply(k,o.results);}).bind(this));};j.prototype.$ResultsBucketizer3=function(k,l){'use strict';if(l.propertyName==null)return l.bucketName||'default';var m=this.$ResultsBucketizer2(k,l.propertyName);if(m==null||l.propertyValue!=null&&''+m!==l.propertyValue)return false;return l.bucketName||l.propertyName+'.'+m;};j.prototype.$ResultsBucketizer4=function(k,l,m){'use strict';var n={},o=false;if(i.renderKeywordsFirst){o=true;}else o=k[0]!=null&&k[0].type===h.keywordType;if(o&&m==null)m=i.default_num_top_results_to_show;k.forEach((function(p,q){l.some((function(r){var s=this.$ResultsBucketizer3(p,r);if(s===false)return false;if(n[s]==null)n[s]={results:[],rule:r};if(o&&s===h.keywordType&&n[s].results.length>=m)return true;if(!!r.maxResults&&n[s].results.length>=r.maxResults)return true;p.bucketLineage.push({bucketName:s,bucketIndex:n[s].results.length});n[s].results.push(p);return true;}).bind(this));}).bind(this));return n;};j.prototype.$ResultsBucketizer5=function(k,l,m){'use strict';var n=this.$ResultsBucketizer1[l];if(!n)return {};var o=this.$ResultsBucketizer4(k,n,m);for(var p in o){var q=o[p].rule.subBucketRules;if(!!q)this.$ResultsBucketizer5(o[p].results,q,m);}j.mergeBuckets(k,o);return o;};j.prototype.$ResultsBucketizer6=function(k,l,m){'use strict';if(l.length<=m)return l.slice();var n=l.map(function(p){return p.indexBeforeBuckets;}),o=n.sort(function(p,q){return p-q;})[m];if(o==null)return l;return l.filter(function(p){return p.indexBeforeBuckets<o;});};j.prototype.bucketize=function(k,l,m,n){'use strict';k.forEach(function(p,q){p.bucketLineage=[];p.indexBeforeBuckets=q;});m=m||{};Object.assign(m,this.$ResultsBucketizer5(k,'main',n));var o=this.$ResultsBucketizer6(m,k,l);return o;};f.exports=j;},null);
__d('FacebarDataSource',['Arbiter','AsyncRequest','FacebarFindPeopleAndPages','FacebarGSv2Echo','FacebarNoFlickerResults','FacebarGlobalOptions','FacebarInviteCoworkers','FacebarJSConstants','FacebarResultStore','FacebarResultStoreUtils','FacebarStructuredText','FacebarTimerUtils','FacebarTokenizer','FacebarTypeNamedXBootstrap','FacebarTypeNamedXTokenOptions','FacebarTypeaheadL2Terms','FacebarTypeaheadTypeNamedX','FacebarURI','ResultsBucketizer','ResultsBucketizerConfig','SearchDataSource','Vector','ViewportBounds','invariant','queryThenMutateDOM','setTimeoutAcrossTransitions','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){if(c.__markCompiled)c.__markCompiled();var ia,ja,ka=50,la={};ia=babelHelpers.inherits(ma,ba);ja=ia&&ia.prototype;function ma(na){'use strict';ja.constructor.call(this,na);this._fetched_null_state=null;this._initialQueryData=null;this._curQueryId=-1;this._maxRemoteQueryId=-1;this._single_state=false;this._waitingQueries=0;this.mixGrammarAndEntity=na.mixGrammarAndEntity!==undefined?na.mixGrammarAndEntity:true;this._num_topresults_to_show=null;this.grammarVersion=na.grammarVersion||'';if(!na.grammarOptions)na.grammarOptions={};this.recordingRoute='banzai_vital';this._maxGrammarResults=na.grammarOptions.maxGrammarResults;this.nullStateEndpoint=na.nullStateEndpoint||'/ajax/browse/null_state.php';this.setNullStateData(na.nullStateData||{},true);this._minQueryLength=na.minQueryLength||-1;this._performShortQuery=na.performShortQuery||false;this._fixProcessLean=na.grammarOptions.fixProcessLean||false;this.hasGSPreload=m.hasGSPreload;this.gsPreloadOptions=m.gsPreloadParams;this.throttleExecuteQuery();this.throttleSendRemoteQuery();this.throttleRenderResults();this.resultStoreOptions=na.grammarOptions||{};this.resultStoreOptions.useNewExactNameMatch=na.grammarOptions.useNewExactNameMatch==="true";this.defaultQuery=null;this._bypassBucketizer=false;this._resultsBucketizer=new z(aa.rules,function(oa,pa){switch(pa){case 'isSeeMore':return oa.isSeeMore;case 'objectType':return oa.type;case 'resultSetType':return oa.results_set_type;case 'renderType':return oa.render_type||oa.type;case 'cacheOnlyResult':return oa.cacheOnlyResult;case 'closeEntity':return oa.bootstrapped||(!!oa.tags?oa.tags[pa]:undefined);default:return !!oa.tags?oa.tags[pa]:undefined;}});this.fetchNullState();this.initWithConfig(m.grammarConfig);}ma.prototype.initWithConfig=function(na){'use strict';this.facebarConfig=na;this.createResultStore();this.blockees={};if(this._fetched_null_state){this.setNullState(this._fetched_null_state);this._fetched_null_state=null;}};ma.prototype.throttleExecuteQuery=function(){'use strict';var na=m.executeQueryThrottleTime;this.executeQueryThrottled=ha.withBlocking(this.executeQuery,na,this);};ma.prototype.throttleSendRemoteQuery=function(){'use strict';var na=m.sendRemoteQueryThrottleTime;if(na===0){this.sendRemoteQueryThrottled=this.sendRemoteQuery;}else if(m.lazyThrottleRemoteQuery){var oa=Date.now(),pa=m.enableSendRemoteQueryDelay,qa=m.sendRemoteQueryDelayTime;this.sendRemoteQueryThrottled=(function(){for(var ra=arguments.length,sa=Array(ra),ta=0;ta<ra;ta++)sa[ta]=arguments[ta];var ua=Date.now();if(oa+na<ua){oa=ua;if(pa){ga((function(){this.sendRemoteQuery.apply(this,sa);}).bind(this),qa);}else this.sendRemoteQuery.apply(this,sa);}}).bind(this);}else this.sendRemoteQueryThrottled=ha.withBlocking(this.sendRemoteQuery,na,this);};ma.prototype.throttleRenderResults=function(){'use strict';var na=m.renderThrottleTime;if(na===0){this.renderResultsThrottled=this.renderResults;return;}var oa=Date.now();this.renderResultsThrottled=(function(pa,qa,ra,sa,ta){var ua=Date.now();if(ra||oa+na<ua){oa=ua;this.renderResults(pa,qa,ra,sa,ta);}}).bind(this);};ma.prototype.createResultStore=function(){'use strict';this.facebarConfig.maxGrammarResults=this._maxGrammarResults;this.resultStore=new p(this.facebarConfig,t.tokenize,this.getEntry.bind(this),this.resultStoreOptions);if(this._fixProcessLean)this._processLean();this.subscribe('setSortFunction',(function(na,oa){this.resultStore.setSortFunction(oa);}).bind(this));};ma.prototype.dirty=function(){'use strict';this._nullStateFetched=false;this.resultStore.resetCaches();ja.dirty.call(this);};ma.prototype.addEntries=function(na){'use strict';this.resultStore.addBootstrap(this.processEntries(na));};ma.prototype._processLean=function(){'use strict';if(this._fixProcessLean){if(this._leanPayload&&this.resultStore){var na,oa=this._leanPayload.entries;for(var pa in oa){na=this.getEntry(pa);if(!na)continue;for(var qa in oa[pa]){if(!na.grammar_costs)na.grammar_costs={};na.grammar_costs['{'+qa+'}']=oa[pa][qa];}}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}}else ja._processLean.call(this);};ma.prototype.setNullStateData=function(na,oa){'use strict';if(oa)this.nullStateData={grammar_version:this.grammarVersion};Object.assign(this.nullStateData,na);return this;};ma.prototype.setNullState=function(na){'use strict';this._null_state=na;this.processEntries(this._null_state.entities);this.resultStore.setNullState(this._null_state.queries);var oa=u.typeNamedX;oa.forEach(function(pa){pa.parse.extendable=true;pa.qid=this._curQueryId;pa.isTypeNamedXBootstrap=true;},this);this.resultStore.addNullStateToQueryCache(this.getRawStructure(r.fromString('')),oa);this._typeNamedXResults={};oa.forEach(function(pa){this._typeNamedXResults[o.grammarToEntityTypes[pa.resultsSetType]]=pa;},this);};ma.prototype.getNullStateTrending=function(){'use strict';return this._null_state.trending;};ma.prototype.setSingleState=function(na){'use strict';this._single_state=na;};ma.prototype.getSingleState=function(){'use strict';return this._single_state;};ma.prototype.overrideNullState=function(na){'use strict';!(this._null_state!=null)?ea(0):undefined;this._original_null_state=this._original_null_state||this._null_state;this.setNullState(na);};ma.prototype.restoreNullState=function(){'use strict';if(this._original_null_state)this.setNullState(this._original_null_state);};ma.prototype.fetchNullState=function(){'use strict';if(this._nullStateFetched){this.activityStart();setTimeout(this.activityEnd.bind(this),0);return;}var na=new i().setURI(this.nullStateEndpoint).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(oa){if(this.resultStore){this.setNullState(oa.payload);this.inform('nullstateReady',true);}else this._fetched_null_state=oa.payload;this._nullStateFetched=true;}).bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();na.send();};ma.prototype.fetchNUXResults=function(na){'use strict';if(!m.allowGrammar)return;na=na||{};var oa=new i().setURI(na.URI).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(pa){if(this.resultStore){this.overrideNullState(pa.payload);na.success&&na.success();}}).bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();oa.send();};ma.prototype.toTypeaheadEntryUid=function(na){'use strict';var oa,pa=r.fromStruct(na.structure),qa=pa.getFragment(0);if(pa.getCount()==1&&qa.isType('ent')){var ra=qa.getType().split(':')[2];oa=this.getEntry(qa.getUID(),ra);oa.type=this.resultStore.stripBrackets(na.type);}else{oa=this.getEntry(na.tuid);if(!oa){oa={dynamic_cost:na.dynamic_cost,extra_uri_params:na.extra_uri_params,memcache:na.fromMemcache,photo:na.photo,results_set_type:na.resultsSetType,tuid:na.tuid,type:na.type,uid:na.tuid,tags:na.tags};this.processEntries([oa]);oa=this.getEntry(na.tuid);}oa.icon_class=na.iconClass;if(m.renderKeywordSnippets){oa.category=na.category;oa.subtext=na.subtext;oa.boldedSubtext=na.boldedSubtext;}}oa.error_info=na.errorInfo;oa.logInfo=na.logInfo;oa.structure=pa;oa.text=oa.structure.toString();oa.queryTypeText=na.queryTypeText;oa.semantic=!!na.isSingleState&&na.singleStateSemantic?na.singleStateSemantic:na.semantic;oa.alternateSemantic=na.alternateSemantic;oa.tree=na.tree;oa.cost=na.cost;oa.isSeeMore=!!na.isSeeMore;oa.isNullState=!!na.isNullState;oa.isSingleState=!!na.isSingleState;oa.keywordSource=na.keywordSource;oa.keyword=na.keyword;var sa=na.keyword_type;oa.isTrending=!!na.isTrending||na.keywordBootstrapType===o.keywordBootstrapTypes.trending||sa===o.keywordTypes.trending;oa.isCelebrity=sa===o.keywordTypes.celebrity;oa.isFootball=sa===o.keywordTypes.football;oa.isPhotos=sa===o.keywordTypes.photos;oa.isVideos=sa===o.keywordTypes.videos;oa.isHashtag=sa===o.keywordTypes.hashtag;oa.isLocal=sa===o.keywordTypes.local||sa===o.keywordTypes.local_category;oa.isCompany=sa===o.keywordTypes.company;oa.isMovie=sa===o.keywordTypes.movie;oa.isHappeningNow=sa===o.keywordTypes.happeningNow;oa.isSpecialIntentGeneric=sa===o.keywordTypes.specialIntentGeneric;oa.isLink=sa===o.keywordTypes.link;o.intentKeys.map(function(ta){oa.isSpecialIntent=oa.isSpecialIntent||oa[ta];});oa.isRecent=!!na.isRecent;oa.isPrefetched=!!na.isPrefetched;oa.isSuggestion=!!na.isSuggestion;oa.isFromGSEF=!!na.isFromGSEF;oa.entityInfo=na.entityInfo;oa.cacheOnlyResult=na.cacheOnlyResult||false;oa.isExtendedResult=na.isExtendedResult||false;if(na.isExtendedResult){oa.uri=y.getURI(this.facebarConfig,oa);}else oa.uri=oa.uri||y.getURI(this.facebarConfig,oa);oa.parse=na.parse;oa.tags=na.tags||{};oa.isKeywordL2=na.isKeywordL2||false;oa.exactMatchKeyword=na.exactMatchKeyword||false;oa.qid=na.qid;oa.templateID=na.templateID;if(na.isJSBootstrapMatch){oa.isJSBootstrapMatch=na.isJSBootstrapMatch;oa.backendCost=na.backendCost;oa.bootstrapCost=na.bootstrapCost;}this._replaceCategoryWithTermMatches(oa,na);return oa.tuid;};ma.prototype._replaceCategoryWithTermMatches=function(na,oa){'use strict';if(na.type!=="user"||!na.term_to_subtitle||!oa.termMatches)return;var pa=[];oa.termMatches.forEach(function(ra){if(na.term_to_subtitle[ra])pa.push(na.term_to_subtitle[ra]);},this);if(na.category===undefined)na.category="";var qa=na.category.split(" \xB7 ");qa.unshift.apply(qa,pa);qa=qa.filter(function(ra,sa,ta){return sa==ta.indexOf(ra);});na.category=qa.splice(0,2).join(" \xB7 ");};ma.prototype.getRawStructure=function(na){'use strict';if(typeof na=='string')na=r.fromString(na);if(this.resultStore)return this.resultStore.transformStructured(na.toArray());};ma.prototype.saveResult=function(na){'use strict';this._initialQueryData=this.getUID(na.uid,na.fetchType);};ma.prototype.isDefaultKeywordQuery=function(na){'use strict';return na.type===o.keywordType&&q.getTextFromResult(na).toLowerCase()===this.value.getHash().trim().toLowerCase();};ma.prototype.buildUids=function(na){'use strict';if(!na||!this.resultStore)return [];if(typeof na==='string')na=r.fromString(na);var oa=this.getRawStructure(na),pa=this.resultStore.getResults(oa,this.getMaxResults()),qa=pa.results;if(typeof qa==='undefined')return [];var ra=pa.null_state===true,sa=0;qa=qa.filter(function(wa,xa){if(!m.allowGrammar&&wa.type=='grammar')return false;return wa.semantic!='<blank>'&&(wa.type!='unimplemented'||sa++===0);},this);var ta=[],ua=[],va=[];qa.forEach(function(wa){if(wa.forcedPosition>0){va.push(wa);}else if(wa.isSeeMore){ta.push(wa);}else ua.push(wa);});if(ra){qa=this.orderNullState(qa,m.maxNullstateResultCount?m.maxNullstateResultCount:this.getMaxResults());}else qa=ua;if(va.length>0){va.sort(function(wa,xa){return wa.forcedPosition-xa.forcedPosition;});va.forEach(function(wa){qa.splice(wa.forcedPosition,0,wa);});}if(ta.length>0)qa.push.apply(qa,ta);return qa.map(this.toTypeaheadEntryUid,this);};ma.prototype.orderNullState=function(na,oa){'use strict';var pa={top:[],bottom:[],middle:[]},qa=function(ta){var ua=ta.null_state_position;return pa.hasOwnProperty(ua)?ua:'middle';},ra=function(ta,ua){return ta.original_cost-ua.original_cost;};na&&na.forEach(function(ta){pa[qa(ta)].push(ta);},this);for(var sa in pa){pa[sa]=pa[sa].sort(ra).slice(0,oa);oa-=pa[sa].length;}return [].concat(pa.top,pa.middle,pa.bottom);};ma.prototype.isEntity=function(na){'use strict';if(!na)return false;return (/^\d+$/.test(na));};ma.prototype.handleResponse=function(na,oa){'use strict';if(!(na.payload.errors)){this.processEntries(na.payload.entities);if(na.payload.blockees)na.payload.blockees.forEach((function(pa){if(!this.blockees.hasOwnProperty(pa))this.blockees[pa.toLocaleLowerCase()]=pa;}).bind(this));na.payload.results.forEach((function(pa){pa.qid=na.queryId;if(!pa.parse)pa.parse={};pa.parse.entTokens=pa.parse.entTokens||[];pa.parse.remTokens=pa.parse.remTokens||[];pa.parse.suffix=pa.parse.suffix||'';if(this.isEntity(pa.semantic))pa=this._buildCommonEntityFields(pa,oa.tokens);}).bind(this));this.saveResults(na,oa);}};ma.prototype.saveResults=function(na,oa){'use strict';var pa=[];if(na.payload.seemore&&this._typeNamedXResults)na.payload.seemore.forEach(function(qa){pa.push(this._typeNamedXResults[qa]);},this);if(na.payload.prefetched)this.processPrefetched(na.payload.prefetched);this.resultStore.saveResults(na.payload.results,oa,na.payload.incomplete,{},pa);};ma.prototype.processPrefetched=function(na){'use strict';for(var oa in na){var pa=r.fromString(oa),qa=this.getRawStructure(pa),ra=na[oa];this.processEntries(ra.entities);ra.results.forEach((function(sa){if(this.isEntity(sa.semantic))sa=this._buildCommonEntityFields(sa,qa.tokens);}).bind(this));this.resultStore.saveResults(ra.results,qa,ra.incomplete);}};ma.prototype.processEntries=function(na){'use strict';return na.map(function(oa,pa){var qa=oa.uid=oa.uid+'';oa.textToIndex=this.getTitleTerms(oa);oa.titleToIndex=this.getTitleTerms(oa);qa=this.getUID(qa,oa.fetchType);var ra=this.getEntry(qa);if(!ra){this.setEntry(qa,{});ra=this.getEntry(qa);}else{delete oa.photo;if(!m.facebarUpdateSnippets){delete oa.category;delete oa.subtext;}}Object.assign(ra,oa);ra.tuid=qa;ra.index===undefined&&(ra.index=pa);return qa;},this);};ma.prototype.getUID=function(na,oa){'use strict';na=na+'';if(oa!==undefined){oa=/([^:]+:)?([^:]+)(:.*)?/.exec(oa)[2];return JSON.stringify([na,oa]);}return na;};ma.prototype.getEntry=function(na,oa){'use strict';var pa;na=''+na;pa=oa!=null?ja.getEntry.call(this,this.getUID(na,oa))||ja.getEntry.call(this,na):ja.getEntry.call(this,na);return pa;};ma.prototype.getEntryForFragment=function(na){'use strict';return this.getEntry(na.getUID(),na.getTypePart(2));};ma.prototype.getMaxResults=function(){'use strict';return this._numResults.max;};ma.prototype.query=function(na,oa,pa){'use strict';this.executeQueryThrottled(na,this._initialQueryData,{keyPress:s.getTimestamp()});this._initialQueryData=null;};ma.prototype.executeQuery=function(na,oa,pa){'use strict';this._curQueryId++;pa.queryId=this._curQueryId;pa.startCacheQuery=s.getTimestamp();var qa=this.getMaxResults()+v.additionalResultsToFetch;this.setQueryData({qid:this._curQueryId,max_results:qa});this.inform('beforeQuery',{value:na,queryId:this._curQueryId});this.value=na;var ra=this.buildUids(na,[]);pa.endCacheQuery=s.getTimestamp();if(oa&&ra.length===0)ra.push(oa);if(m.sendExistingIDs){var sa=[];ra.forEach(function(ta){var ua=this.getEntry(ta);if(ua&&ua.type in o.entityTypes)sa.push(ua.uid);},this);if(sa.length>0)this.setQueryData({qid:this._curQueryID,existing_ids:JSON.stringify(sa),max_results:qa});}this.inform('query',{value:na,results:ra,queryId:this._curQueryId});if(this.resultStore)this.respond(na,ra,false,false,pa);};ma.prototype.shouldFetchMore=function(na,oa){'use strict';if(!na.is_empty&&m.fetchMoreKeywords){var pa=oa.filter(function(qa){return qa.type===o.keywordType;});return pa<m.default_num_top_results_to_show;}if(na.is_empty)return false;if(this.resultStore.alreadyKnown(na.cache_id))return false;if(na.raw_text&&this._isQueryTooShort(na.raw_text))return false;if(m.alwaysFetchMore)return true;if(oa.length<this.getMaxResults()||this._performShortQuery)return true;return this.countValidResults(oa)<this.getMaxResults()||this._performShortQuery;};ma.prototype.countValidResults=function(na){'use strict';var oa=0;na.forEach(function(pa){if(pa&&!pa.isNullState&&!pa.isSeeMore)oa++;},this);return oa;};ma.prototype.sendRemoteQuery=function(na,oa,pa,qa,ra){'use strict';var sa=this._single_state,ta=this.getQueryData(na.text_form);ta.gs_prefetch_mode=qa;if(ra)ta.max_results=ra;this._sendingOrProcessingRemoteQuery=true;var ua=new i().setURI(this.queryEndpoint).setData(ta).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(va,wa){if(qa&&wa.payload.is_user)return;var xa=wa.payload;wa.queryId=va;wa.inputQuery=na.text_form;if(xa.results!=null)xa.results.forEach(function(za){za.isSingleState=sa;za.isFromGSEF=qa;});pa.endRemoteQuery=s.getTimestamp();this.inform('response_received',wa);this.handleResponse(wa,na);var ya=[];if(xa.abandon_cache)ya=xa.results.map(this.toTypeaheadEntryUid,this);this.respond(oa,ya,true,xa&&(!xa.results||xa.results.length===0),pa,xa.num_topresults_to_show);this.inform('backend_response',wa);if(m.disable_snowballing){this.resultStore.resetQueryCache();this.saveResults(wa,na);}}).bind(this,pa.queryId)).setFinallyHandler((function(){this._sendingOrProcessingRemoteQuery=false;this.activityEnd();}).bind(this));this.inform('sending_request',ua);this._maxRemoteQueryId=pa.queryId;pa.waitingQueries=this._waitingQueries;pa.inflightRequests=i.getInflightCount();pa.startRemoteQuery=s.getTimestamp();ua.send();this.activityStart();};ma.prototype.activityStart=function(){'use strict';if(!this._waitingQueries)this.inform('activity',{activity:true},h.BEHAVIOR_STATE);this._waitingQueries++;};ma.prototype.activityEnd=function(){'use strict';this._waitingQueries--;if(!this._waitingQueries)this.inform('activity',{activity:false},h.BEHAVIOR_STATE);};ma.prototype._bucketizeResults=function(na,oa,pa){'use strict';oa=this._tagKeywordsSuggestions(oa);oa=w.addL2Terms(oa,this.getMaxResults(),na.toString(),m);oa=x.addTypeNamedX(oa,this.getMaxResults(),na.toString(),m);return this._resultsBucketizer.bucketize(oa,ka,null,pa);};ma.prototype._tagKeywordsSuggestions=function(na){'use strict';if(!na||na.length===0)return na;var oa=na[0];if(oa.bootstrapped)return na;if(oa.type==='grammar'||oa.cost<m.closeEntityThreshold&&oa.type==='user')return na;return na.map(function(pa){if(pa.type!==o.keywordType)return pa;pa=babelHelpers._extends({},pa);pa.tags.topBucket=true;return pa;});};ma.prototype._buildCommonEntityFields=function(na,oa){'use strict';if(na.queryTypeText)return na;if(m.unbreakParseDisplay){na.parse.display=[{type:'ent:'+na.type,uid:na.semantic}];}else na.parse.display=[{type:'ent:'+na.type,uid:parseInt(na.semantic,10)}];if(na.parse.fetchType)na.parse.display[0].fetchType=na.parse.fetchType;na.parse.entTokens=oa;na.parse.pos=0;na.resultsSetType='{'+na.type+'}';na.queryTypeText=o.defaultQueryTypeText;return na;};ma.prototype.setBypassBucketizer=function(na){'use strict';this._bypassBucketizer=na;};ma.prototype.respond=function(na,oa,pa,qa,ra,sa){'use strict';if(pa&&this.value){if(typeof this.value==='string')this.value=r.fromString(this.value);this.inform('remote_query_match',{isMatch:this.value.matches(na),queryId:ra?ra.queryId:0});na=this.value;if(!oa||oa.length===0)oa=this.buildUids(na);}this.inform('reorderResults',oa);this.inform('respondValidUids',oa);var ta=oa.map(this.getEntry,this);ta.forEach(function(va,wa){va.fromCache=!pa;va.isSingleState=this._single_state;},this);if(!pa&&(na.getHash().length<512||na.getHash().startsWith('http://')||na.getHash().startsWith('https://'))){var ua=this.getRawStructure(na);if(this.shouldFetchMore(ua,ta)){if(ra!=null)ra.dispatchRemoteQuery=s.getTimestamp();if(this.hasGSPreload){this.sendRemoteQueryThrottled(ua,na,ra,true,this.gsPreloadOptions.max_entities_to_fetch);this.sendRemoteQueryThrottled(ua,na,ra);}else this.sendRemoteQueryThrottled(ua,na,ra);}}if(!pa||!ra||ra.queryId===this._maxRemoteQueryId)this.renderResultsThrottled(na,ta,pa,qa,sa);if(ra!=null)this.logLatencies(pa,ra);};ma.prototype.renderResults=function(na,oa,pa,qa,ra){'use strict';if(ra!=null){la[String(na)]=ra;}else ra=la[String(na)];k.insertInto(na,oa,!pa,this._single_state);if(m.graphSearchV2&&m.hasFlickerFix&&na!=null&&this._single_state!==true)l.insertInto(na,oa,pa,this._sendingOrProcessingRemoteQuery);if(!!na&&(na instanceof r&&!na.isEmptyOrWhitespace())&&!this._bypassBucketizer)oa=this._bucketizeResults(na,oa,ra);oa.length=Math.min(oa.length,this.getMaxResults());this.injectExtraResults(na,oa);qa=pa&&oa.length===0;this.inform('respond',{value:na,results:oa,isAsync:!!pa,isEmptyResults:qa});};ma.prototype.injectExtraResults=function(na,oa,pa){'use strict';j.insertInto(na,oa,!pa,this._single_state);n.insertInto(na,oa,!pa,this._single_state);};ma.prototype.logLatencies=function(na,oa){'use strict';var pa=s.getTimestamp();if(na){this.inform('remote_query_latency',{queryId:oa.queryId,latencies:{queryStart:Math.max(oa.startRemoteQuery-oa.dispatchRemoteQuery,0),queryEnd:Math.max(oa.endRemoteQuery-oa.startRemoteQuery,0),keyPressToQueryDispatch:Math.max(oa.dispatchRemoteQuery-oa.keyPress,0),keyPressToQueryStart:Math.max(oa.startRemoteQuery-oa.keyPress,0),keyPressToQueryEnd:Math.max(oa.endRemoteQuery-oa.keyPress,0),render:Math.max(pa-oa.endRemoteQuery,0),inflightRequests:oa.inflightRequests,waitingQueries:oa.waitingQueries,keyPressToRender:Math.max(pa-oa.keyPress,0)}});}else this.inform('cache_query_latency',{queryId:oa.queryId,latencies:{queryStart:Math.max(oa.startCacheQuery-oa.keyPress,0),queryEnd:Math.max(oa.endCacheQuery-oa.startCacheQuery,0),keyPressToQueryEnd:Math.max(oa.endCacheQuery-oa.keyPress,0),render:Math.max(pa-oa.endCacheQuery,0),keyPressToRender:Math.max(pa-oa.keyPress,0)}});};ma.prototype._updateMaxResults=function(){'use strict';fa((function(){var na=ca.getViewportDimensions().y,oa=da.getTop()||42,pa=56,qa=48,ra=na-oa-qa-25;this._maxResults=Math.max(this._numResults.min,Math.min(this._numResults.max,Math.floor(ra/pa)-1));this.value&&this.query(this.value);}).bind(this));};ma.prototype.getCurQueryId=function(){'use strict';return this._curQueryId;};ma.prototype.setTypenamedXOption=function(na){'use strict';m.showTypeNamedX=na;};ma.prototype.setMinQueryLength=function(na){'use strict';this._minQueryLength=na;};ma.prototype.setGrammarOption=function(na){'use strict';m.allowGrammar=na;};Object.assign(ma.prototype,{events:['query','respond','bootstrapped','activity','ready']});f.exports=ma;},null);
__d('FacebarTypeaheadDebugPane.react',['Banzai','LeftRight.react','React','Image.react'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes,m=j.createClass({displayName:'FacebarTypeaheadDebugPane',propTypes:{result:l.object.isRequired},getInitialState:function(){return {feedbackSent:false};},componentWillReceiveProps:function(n){if(n.result!==this.props.result)this.setState({feedbackSent:false});},sendFeedback:function(n){var o=this.props.result;if(o.decoration.entity===o)o.decoration.entity='';var p=JSON.stringify(o),q=JSON.stringify(o.debug.allResults),r={result:p,query:o.debug.query,position:o.debug.position,sid:o.debug.sid,allResults:q,isOK:n};h.post('facebar_feedback',r,{delay:0});this.setState({feedbackSent:true});this.setState({feedbackOK:n});return false;},renderDebugText:function(n){return j.createElement('div',{key:n},n);},render:function(){var n=this.sendFeedback.bind(this,true),o=this.sendFeedback.bind(this,false),p=this.state.feedbackSent,q=p&&this.state.feedbackOK,r=p&&!this.state.feedbackOK;return (j.createElement('div',{className:'fsm pam'},j.createElement(i,null,j.createElement('div',null,this.props.result.debug.map(this.renderDebugText)),j.createElement('div',null,j.createElement('div',{className:q?'':'hidden_elem'},j.createElement('strong',null,'Feedback sent'),j.createElement(k,{className:'mls',src:'/images/green_up.gif'})),j.createElement('div',{className:r?'':'hidden_elem'},j.createElement('strong',null,'Feedback sent'),j.createElement(k,{className:'mls',src:'/images/red_down.gif'})),j.createElement('div',{className:p?'hidden_elem':''},j.createElement('a',{href:'#',onClick:n},j.createElement(k,{src:'/images/green_up.gif'})),j.createElement('a',{href:'#',onClick:o},j.createElement(k,{className:'mls',src:'/images/red_down.gif'})))))));}});f.exports=m;},null);
__d('FacebarTypeaheadDiffText.react',['React','cx'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes,k=h.createClass({displayName:'FacebarTypeaheadDiffText',propTypes:{prefix:j.string,text:j.string},renderDiff:function(l,m){return (h.createElement('span',{className:"diffNode _5td3",key:m},l));},renderParts:function(){var l=this.props.prefix,m=this.props.text;if(l==null)return this.renderDiff(m,0);var n=m.toLowerCase().indexOf(l.toLowerCase());l=l.trim();if(n===0)m=m.slice(l.length);var o=m.split(/\b/).map(this.renderDiff);if(n===0)o.unshift(l);return o;},render:function(){return (h.createElement('span',this.props,this.renderParts()));}});k.generatePrefixes=function(l,m){var n=[],o,p;for(var q=0,r=m.length;q<r;q++){p=m[q].getText();o=l.slice(0,Math.min(l.length,p.length));if(o==='')return n;if(p.toLowerCase().indexOf(o.toLowerCase())===0){n.push(o);l=l.slice(o.length);}else return n;}return n;};f.exports=k;},null);
__d('FacebarTypeaheadHighlightedText.react',['BrowseFacebarHighlighter','React'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i.PropTypes,k=i.createClass({displayName:'FacebarTypeaheadHighlightedText',propTypes:{text:j.string,tokens:j.array},renderHighlight:function(l,m){if((m+1)%3===0){return i.createElement('span',{className:'highlightNode',key:m},l);}else if(l)return l;},renderParts:function(){var l=this.props.text,m=this.props.tokens;if(m&&l){var n=h.createRegex(m),o=l.split(n);return o.map(this.renderHighlight);}else return l;},render:function(){return (i.createElement('span',this.props,this.renderParts()));}});f.exports=k;},null);
__d('FacebarTypeaheadItem.react',['Badge.react','React','FacebarGlobalOptions','FacebarTypeaheadDebugPane.react','FacebarTypeaheadDiffText.react','FacebarTypeaheadHighlightedText.react','TimelineFilterOptions','URI','XUICloseButton.react','TypeaheadCanvasConfig','FacebarJSConstants','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=i.PropTypes;function v(x){var y=x.getTypePart(0);return y?'fragment'+y.charAt(0).toUpperCase()+y.substr(1):'fragment';}var w=i.createClass({displayName:'FacebarTypeaheadItem',propTypes:{result:u.object.isRequired,className:u.string,icon:u.object,token:u.object,highlight:u.array,prefix:u.string,message:u.object,valign:u.bool},getDefaultProps:function(){return {valign:true};},renderHighlightedFragment:function(x,y){return (i.createElement(m,{className:v(x),key:y,text:x.getText(),tokens:this.props.highlight}));},renderDiffedFragment:function(x,y,z){return (i.createElement(l,{className:v(x),key:z,prefix:y,text:x.getText()}));},renderText:function(){var x=this.props.result,y=x.displayStructure!=null?x.displayStructure.toArray():x.structure.toArray(),z=this.props.prefix;if(j.graphSearchV2&&!x.isSeeMore&&z!=null&&z.trim()!==''){var aa=l.generatePrefixes(z,y);return y.map((function(ba,ca){if(!aa[ca])aa[ca]='';return this.renderDiffedFragment(ba,aa[ca],ca);}).bind(this));}else return y.map(this.renderHighlightedFragment);},renderBadge:function(){if(this.props.result.photo&&this.props.showSecondaryIcon&&!this.props.result.isTrending)return (i.createElement('span',{className:"_34my"}));if(this.props.result.category&&this.props.result.category.toLowerCase()==='game'&&q.in_games_v1){if(q.badge_color==='blue'){return (i.createElement(h,{type:'game_blue',size:'medium'}));}else if(q.badge_color==='green')return (i.createElement(h,{type:'game_new_green',size:'medium'}));return (i.createElement(h,{type:'game_green',size:'medium'}));}else if(this.props.result.is_verified){return (i.createElement(h,{type:'verified',size:'medium'}));}else if(this.props.result.is_work_user){return (i.createElement(h,{type:'work',size:'medium'}));}else if(this.props.result.pages_verified_badge===1)return (i.createElement(h,{type:'page_gray_check',size:'medium'}));},renderIcon:function(){var x=this.props.result,y=x.icon_class;if(y){return (i.createElement('span',{className:"_k83"},i.createElement('span',{className:y})));}else if(x.photo)return (i.createElement('img',{className:"_20h",alt:'',src:x.photo}));},renderSecondaryIcon:function(){var x=this.props.result;if(x.photo&&this.props.showSecondaryIcon)return (i.createElement('div',{className:"_20h"},i.createElement('img',{alt:'',src:x.photo})));},renderLabel:function(){var x=' \u00B7 ',y=this.props.result,z="_53ad"+(this.props.valign&&this.props.token&&this.props.token.props&&this.props.token.props.text.length>0?' '+"_55y-":'')+(!y.category&&!y.subtext?' '+"_2vzo":'')+(!y.category&&!!y.subtext||y.category&&y.category.indexOf(x)<0&&!y.subtext?' '+"_2vzp":'')+(y.category&&!!y.subtext||y.category&&y.category.indexOf(x)>0?' '+"_2vzq":''),aa=i.createElement('span',{className:z},this.renderText(),this.renderBadge(),this.props.token),ba="_7gk"+(this.props.message?' '+"_5byz":'');return (i.createElement('span',{className:ba,style:{maxWidth:j.maxTypeaheadWidth+'px'}},aa,this.props.message));},renderMain:function(){var x=i.createElement('a',{className:"_6i1",href:this.props.result.uri},i.createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel(),this.renderSecondaryIcon()));if(this.props.result.isAsync)x=i.createElement('a',{className:"_6i1",href:'#',ajaxify:this.props.result.asyncURI,rel:'async'},i.createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel(),this.renderSecondaryIcon()));return (i.createElement('span',{className:"_205",rel:'ignore'},this.renderActivityLogXButton(),x));},renderActivityLogXButton:function(){if(this.props.result.keywordBootstrapType!==r.keywordBootstrapTypes.recent)return null;var x=new o('/me/allactivity');x.setQueryData({privacy_source:'activity_log',log_filter:n.SEARCH});return (i.createElement(p,{size:'medium',className:"_2d9t",href:x}));},renderDebug:function(){return this.props.result.debug?i.createElement(k,{result:this.props.result}):null;},render:function(){var x="_202"+(' '+"_5bl2")+(' '+"_6_k")+(j.graphSearchV2?' '+"_1et7":'')+(j.renderKeywordSnippets?' '+"_28vg":'')+(this.props.result.isCelebrity?' '+"_5g-n":'')+(this.props.result.isSeeMore?' '+"_qbs":'')+(this.props.result.isTrending?' '+"_5g-o":'')+(this.props.result.isRecent?' '+"_jsd":'')+(this.props.result.isLocal?' '+"_1821":'')+(this.props.result.isFootball?' '+"_1822":'')+(this.props.result.isHashtag?' '+"_4z1b":'')+(this.props.result.isPhotos?' '+"_4z1c":'')+(this.props.result.isVideos?' '+"_4z1d":'')+(j.hasCompactTypeaheadStyle?' '+"_1aa_":'')+(this.props.result.isInvalidated?' '+"_44vm":'');return (i.createElement('li',{className:t(x,this.props.className),onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,role:'option'},this.renderMain(),this.renderDebug()));}});f.exports=w;},null);
__d('FacebarTypeaheadToken.react',['FacebarTypeaheadHighlightedText.react','React','cx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=i.PropTypes,l=' \u00B7 ',m=i.createClass({displayName:'FacebarTypeaheadToken',propTypes:{text:k.array.isRequired,highlight:k.array,limit:k.number,mainClass:k.string,innerClass:k.string,leadingMiddot:k.bool,savedContext:k.string,category:k.string},render:function(){var n=null;if(this.props.savedContext)n=i.createElement('span',{className:"_10j2"},this.props.savedContext);var o=this.props.text;if(this.props.limit)o.splice(this.props.limit);o.forEach((function(s,t){if(t!==0||this.props.leadingMiddot||n)o[t]=l+s;}).bind(this));var p=i.createElement(h,{className:this.props.mainClass,tokens:this.props.highlight,text:o.shift()}),q=o.length?i.createElement(h,{tokens:this.props.highlight,className:"_53ab",text:o.join('')}):null,r=this.props.innerClass||"_53aa";return (i.createElement('span',{className:"_53a9"},i.createElement('span',{className:r},n,p,q)));}});f.exports=m;},null);
__d('FacebarTypeaheadTokenText',['HTML','FbtResult','getElementText'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k='\u00B7';function l(p){if(p instanceof i){return p.toString();}else if(typeof p==='object'){return j(h(p).getRootNode());}else return p||'';}function m(p){return l(p).split(k).map(function(q){return q.trim();});}function n(p){var q={};return p.filter(function(r){var s=!q[r];q[r]=true;return s&&r;});}var o={textForEntity:function(p,q){var r=p.category||q[p.type]||'',s=p.subtext||'',t=p.boldedSubtext||'',u=m(r).concat(m(t)).concat(m(s));return n(u);},text:function(p){return n(m(p));}};f.exports=o;},null);
__d('FacebarTypeaheadEntityItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','TypeaheadFacepileX.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=l.createClass({displayName:'FacebarTypeaheadEntityItem',renderToken:function(){return (l.createElement(j,{highlight:this.getHighlightTokens(),text:k.textForEntity(this.props.result,{}),category:this.props.result.category,savedContext:this.props.result.saved_context}));},renderIcon:function(){if(this.props.result.isNullState){var q=this.props.result.icon_class?l.createElement('span',{className:this.props.result.icon_class}):l.createElement('img',{className:"_20h",src:this.props.result.photo});return (l.createElement('span',{className:!h.renderKeywordSnippets?"_k83":''},q));}if(this.props.result.size>1&&this.props.result.photos){return (l.createElement(m,{className:"_51l_",photos:this.props.result.photos,size:this.props.result.size}));}else if(this.props.result.photo)return (l.createElement('img',{className:"_20h",alt:'',src:this.props.result.photo}));},getHighlightTokens:function(){if(this.props.result.original_query){var q=this.props.result.original_query.toString().trim(),r=q.split(' '),s=r.length>1?[q].concat(r):[q];return s.filter(function(t){return t!=='';});}},render:function(){var q=this.props.className;if(this.props.result.isNullState)q=o(this.props.className,!h.renderKeywordSnippets?"_207":'');return (l.createElement(i,babelHelpers._extends({},this.props,{className:q,icon:this.renderIcon(),token:this.renderToken(),highlight:this.getHighlightTokens(),valign:true})));}});f.exports=p;},null);
__d('FacebarDisambiguationDialog',['Event','BrowseLogger','CSS','cx','Dialog','DOM','FacebarStructuredText','FacebarTypeaheadEntityItem.react','React','ReactDOM','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=650;function t(u,v,w,x,y){'use strict';this._sets=u;this._path=v;this._ondone=w;this._oncancel=x;this._selection=[];this._typeaheadSID=y;}t.prototype.show=function(){'use strict';new l().setTitle(r._("Which of these did you mean?")).setBody(this._createBody()).setContentWidth(s).setModal(true).setButtons([l.CONFIRM,l.CANCEL]).setHandler(this._handleDone.bind(this)).setCancelHandler(this._handleCancel.bind(this)).show();this._sets.forEach((function(u){var v=[];u.forEach(function(x){v.push(x.uid);});var w=u[0];i.logDisambiguationImpression(w.text,w.type,this._path,v.join(','),this._typeaheadSID);}).bind(this));};t.prototype._createBody=function(){'use strict';var u=[];this._sets.forEach((function(v,w){u.length&&u.push(m.create('li',{className:"_200"}));v.forEach((function(x){var y=this._createItem(x,w);this._selection[w]||this._selectItem(y);u.push(y.root);}).bind(this));}).bind(this));return m.create('ul',{className:'viewList disambiguationList'},u);};t.prototype._createItem=function(u,v){'use strict';var w={uri:null,subtext:u.subtext,category:u.category,photo:u.photo,type:u.type,structure:n.fromStruct([{text:u.text,type:'ent:'+u.type,uid:u.uid}])},x=m.create('div',{className:"_201"}),y=p.createElement(o,{result:w}),z=m.create('div');q.render(y,z);var aa=z.firstChild;j.addClass(aa,"_6i3");m.appendContent(aa,j.hide(x));var ba={setId:v,result:u,root:aa,check:x};h.listen(aa,'mouseover',this._toggleHover.bind(this,ba,true));h.listen(aa,'mouseout',this._toggleHover.bind(this,ba,false));h.listen(aa,'click',(function(event){this._selectItem(ba);return event.kill();}).bind(this));return ba;};t.prototype._toggleHover=function(u,v){'use strict';j.conditionClass(u.root,'selected',v);};t.prototype._toggleCheck=function(u,v){'use strict';j.conditionShow(u.check,v);};t.prototype._selectItem=function(u){'use strict';var v=this._selection[u.setId];this._selection[u.setId]=u;v&&this._toggleCheck(v,false);this._toggleCheck(u,true);};t.prototype._handleDone=function(u){'use strict';this._ondone(u==l.CONFIRM?this._selection.map((function(v){var w=v.result;i.logDisambiguationClick(w.text,w.type,this._path,w.index,w.uid,this._typeaheadSID);return w;}).bind(this)):null);};t.prototype._handleCancel=function(){'use strict';this._oncancel();};f.exports=t;},null);
__d('FacebarTypeahead',['Arbiter','Typeahead','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;k=babelHelpers.inherits(m,i);l=k&&k.prototype;function m(n,o,p,q,r,s){'use strict';l.constructor.call(this,n,o,p,q);this.getCore();this.proxyEvents();this.initBehaviors(r||[]);var t=this.core.subscribe('focus',(function(){if(s)s.init(this);this.core.unsubscribe(t);this.data.bootstrap(false);this.core.input.focus();}).bind(this));this.data.bootstrap(true);this.inform('init',this,h.BEHAVIOR_PERSISTENT);h.inform('Facebar/init',this,h.BEHAVIOR_PERSISTENT);}m.prototype.proxyEvents=function(){'use strict';var n,o=[],p=null,q=(function(){while(n=o.shift())this.inform(n[0],n[1]);p=null;}).bind(this);[this.data,this.view,this.core].forEach(function(r){r.subscribe(r.events,(function(s,t){o.push([s,t]);p=p||setTimeout(q,0);}).bind(this));},this);};Object.assign(m.prototype,{init:j});f.exports=m;},null);
__d('StructuredInputDOM',['createArrayFromMixed','CSS','cx','DOM','FacebarGlobalOptions','getElementText','isElementNode','isTextNode'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=function(){return l.graphSearchV2?"_4v1s":"_586o";},q={ENTITY_CLASS:p(),encodeText:function(r){return r.replace(/ /g,'\u00a0');},decodeText:function(r){return r.replace(/\u00a0/g,' ');},createIconNode:function(r){if(r&&typeof r=='object'){var s=k.create('i',{className:r.className,style:r.uri&&{backgroundImage:'url("'+r.uri+'")'}});s.setAttribute('data-select','ignore');return s;}},createTextNode:function(r){return k.create('span',{'data-si':true},q.encodeText(r||""));},createEntityNode:function(r,s){var t=q.encodeText(r.text),u=q.createIconNode(s.icon),v=k.create('span',{},u?[u,t]:t),w=(s.className||'').split(/\s+/);w.push(q.ENTITY_CLASS);w.forEach(i.addClass.bind(i,v));var x={si:true,uid:r.uid,type:r.type,text:t,fulltext:t,group:s.group,select:s.select,icon:JSON.stringify(s.icon||null)};for(var y in x)if(x[y]!=null)v.setAttribute('data-'+y,x[y]);return v;},convertToTextNode:function(r){r.className='';r.setAttribute('data-type','text');r.removeAttribute('data-group');r.removeAttribute('data-select');r.removeAttribute('data-icon');r.removeAttribute('data-uid');for(var s=r.firstChild;s;s=s.nextSibling)if(!o(s))k.remove(s);},isEntityNode:function(r){return n(r)&&i.hasClass(r,q.ENTITY_CLASS);},containsOnlyText:function(r,s){s=h(s);for(var t=r.firstChild;t;t=t.nextSibling)if(!(o(t)||r.nodeName in s))return false;return true;},getText:function(r){return m(r).replace(/ /g,'\u00a0');},getDecodedText:function(r){return q.decodeText(m(r));},getLength:function(r){return m(r).length;},getMarker:function(r,s,t){var u=r.firstChild;while(u){var v=q.getLength(u);if(v>s||!u.nextSibling){if(o(u)||!t){return {node:u,offset:Math.min(s,v)};}else return q.getMarker(u,s);}else s-=v;u=u.nextSibling;}}};f.exports=q;},null);
__d('StructuredInputUtil',['StructuredInputDOM'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(o,p,q){var r=o.substr(0,p).lastIndexOf(q);return r!==-1?r+1:0;}function j(o,p,q){var r=o.indexOf(q,p);return r!==-1?r:o.length;}function k(o,p,q){return (p===0||p===o.length||o.substr(p,q.length)==q);}function l(o,p,q,r){switch(p){case 'none':return q;case 'all':return r?o.length:0;case 'word':if(k(o,q,'\u00a0')){return q;}else if(r){return j(o,q,'\u00a0');}else return i(o,q,'\u00a0');}}function m(o,p){return p&&h.isEntityNode(o)&&!h.isEntityNode(p);}var n={getMarkerAtOffset:function(o,p){var q=o.firstChild,r=0,s=0;while(q){r+=s;s=h.getLength(q);if(r+s>p){break;}else q=q.nextSibling;}return {node:q||o.lastChild,offset:p-r};},validateEntityText:function(o){var p=h.getText(o),q=o.getAttribute('data-fulltext'),r=o.getAttribute('data-group');if(r=='hashtag'){var s=p.match(/#[^\s]+/);q=s&&s[0];}var t=p.indexOf(q),u={prefix:null,entity:null,suffix:null};switch(r){case 'none':u.entity=p;break;case 'hashtag':case 'all':if(t!=-1){u.prefix=p.substr(0,t);u.entity=p.substr(t,q.length);u.suffix=p.substr(t+q.length);}else u.suffix=p;break;case 'word':if(t!=-1){u.prefix=p.substr(0,t);p=p.substr(t);}var v=0,w=0;while(v<q.length){w=j(q,v+1,'\u00a0');if(p.substr(0,w)!=q.substr(0,w)){break;}else v=w;}u.entity=p.substr(0,v)||null;u.suffix=p.substr(v)||null;}return u;},getGrouping:function(o,p){var q=o.getAttribute('data-group'),r=o.getAttribute('data-select');if(p=='select'){return r=='group'?q:'none';}else return q;},snapMarkerToText:function(o,p){var q=o.node;if(h.isEntityNode(q)){var r=o.offset,s=n.getGrouping(q,p);if(s!='none')if(r===0){var t=q.previousSibling;if(m(q,t))return {node:t,offset:h.getLength(t)};}else if(r==h.getLength(q)){var u=q.nextSibling;if(m(q,u))return {node:u,offset:0};}}return o;},nextMarkerBoundary:function(o,p,q){var r=o.node;if(h.isEntityNode(r)&&(!p||o.offset!==0)){var s=n.getGrouping(r,q);if(s!='none')return {node:o.node,offset:l(h.getText(r),s,o.offset,p)};}return o;}};f.exports=n;},null);
__d('StructuredInputCleaner',['DOM','createArrayFromMixed','StructuredInputUtil','StructuredInputDOM','UserAgent_DEPRECATED','getElementText','isTextNode'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(p,q,r){'use strict';this._node=p;this._selection=q;this._wrapText=r;}o.prototype._cleanEntityNode=function(p){'use strict';var q=p.getAttribute('data-text'),r=k.getText(p);p.style.cssText='';if(q==r&&k.containsOnlyText(p,{I:true}))return null;var s=[],t=j.validateEntityText(p),u=k.createIconNode(JSON.parse(p.getAttribute('data-icon')));if(!t.entity&&(t.suffix&&!t.prefix||t.prefix&&!t.suffix)){k.convertToTextNode(p);p.setAttribute('data-text',r);return null;}if(t.prefix)s.push(this._createTextNode(t.prefix));if(t.entity){if(this._selection&&m(p)!==t.entity)this._selection.markDirty(p);h.setContent(p,u?[u,t.entity]:t.entity);p.setAttribute('data-text',t.entity);s.push(p);}if(t.suffix)s.push(this._createTextNode(t.suffix));return s;};o.prototype._removeSpecialNodes=function(){'use strict';var p=i(this._node.getElementsByTagName('script')),q=i(this._node.getElementsByTagName('style'));p.forEach(h.remove);q.forEach(h.remove);};o.prototype._collapseNodes=function(){'use strict';for(var p,q=this._node.firstChild;q;q=p){p=q.nextSibling;if(!n(q)&&!k.isEntityNode(q)&&!k.containsOnlyText(q))for(var r=q.lastChild;r;r=q.lastChild){this._node.insertBefore(r,p);p=r;}}};o.prototype._createTextNode=function(p){'use strict';if(this._wrapText){return k.createTextNode(p);}else return document.createTextNode(p);};o.prototype.replaceNodes=function(p,q){'use strict';if(q==null)return;var r=p.length?p[p.length-1].nextSibling:null;p.forEach(function(s){if(q.indexOf(s)===-1)h.remove(s);},this);q.reverse().forEach(function(s){if(p.indexOf(s)===-1)this._node.insertBefore(s,r);r=s;},this);};o.prototype.clean=function(){'use strict';this._removeSpecialNodes();this._collapseNodes();var p=[],q=(function(){if(p.length){this.replaceNodes(p,this._cleanTextNodes(p));p.length=0;}}).bind(this);i(this._node.childNodes).forEach((function(r){if(k.isEntityNode(r)){this.replaceNodes([r],this._cleanEntityNode(r));q(p);}else p.push(r);}).bind(this));q();if(!this._node.firstChild&&l.firefox())this._node.appendChild(this._createTextNode());};o.prototype.endOnText=function(){'use strict';var p=(function(q,r){if(k.isEntityNode(q))this._node.insertBefore(this._createTextNode(),r?q:null);}).bind(this);p(this._node.firstChild,true);p(this._node.lastChild,false);};Object.assign(o.prototype,{_cleanTextNodes:(function(){var p=function(r){return (r.nodeName==='BR'||r.nodeName==='SPAN'&&q(r));},q=function(r){return r.getAttribute('data-si')&&k.containsOnlyText(r)&&k.getLength(r)>0;};return function(r){if(r.length!=1||!p(r[0])){var s=r.map(k.getText).join('').replace(/\s+/g,' ');return s?[this._createTextNode(s)]:[];}else{r[0].style.cssText='';return;}};})()});f.exports=o;},null);
__d("DOMSelection",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();(function(){var h=this,i={isPreceding:function(o,p){return p.compareDocumentPosition(o)&2;},contains:function(o,p){if(o.compareDocumentPosition!=null){return o.compareDocumentPosition(p)&16;}else return o.contains(p);},isCursorPreceding:function(o,p,q,r){if(o===q)return p<=r;if(i.isText(o)&&i.isText(q))return i.isPreceding(o,q);if(i.isText(o)&&!i.isText(q))return !i.isCursorPreceding(q,r,o,p);if(!i.contains(o,q))return i.isPreceding(o,q);if(o.childNodes.length<=p)return false;if(o.childNodes[p]===q)return 0<=r;return i.isPreceding(o.childNodes[p],q);},isText:function(o){return (o!=null?o.nodeType==3:false);},getChildIndex:function(o){var p=0;while(o=o.previousSibling)p++;return p;}},j=h.Selection=(function(){function o(p){this.win=p;}o.prototype.hasSelection=function(){return o.hasSelection(this.win);};o.prototype.isBidirectional=function(){return o.isBidirectional(this.win);};o.prototype.getOrigin=function(){return o.getOrigin(this.win);};o.prototype.getFocus=function(){return o.getFocus(this.win);};o.prototype.getStart=function(){return o.getStart(this.win);};o.prototype.getEnd=function(){return o.getEnd(this.win);};o.prototype.trySelection=function(p,q,r,s){return o.trySelection(this.win,p,q,r,s);};o.prototype.setSelection=function(p,q,r,s){return o.setSelection(this.win,p,q,r,s);};o.prototype.clearSelection=function(){return o.clearSelection(this.win);};return o;})();function k(){if(h.document.selection&&/MSIE 9\./.test(navigator.userAgent)){return false;}else return !!h.getSelection;}if(k()){j.supported=true;j.hasSelection=function(o){var p;return (p=o.getSelection())&&(p.focusNode!=null)&&(p.anchorNode!=null);};j.isBidirectional=function(o){return true;};j.getOrigin=function(o){var p;if(!((p=o.getSelection())&&(p.anchorNode!=null)))return null;return [p.anchorNode,p.anchorOffset];};j.getFocus=function(o){var p;if(!((p=o.getSelection())&&(p.focusNode!=null)))return null;return [p.focusNode,p.focusOffset];};j.getStart=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [p,r];return [q,s];};j.getEnd=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [q,s];return [p,r];};var l=function(o,p,q,s,t,u){var v=p.getSelection();if(!v)return;if(t==null)t=q;if(u==null)u=s;if(v.collapse&&v.extend){v.collapse(q,s);v.extend(t,u);}else{r=p.document.createRange();r.setStart(q,s);r.setEnd(t,u);if(o||!j.hasSelection(p)||(r.endContainer===t&&r.endOffset===u&&r.startContainer===q&&r.startOffset===s)){try{v.removeAllRanges();}catch(w){}v.addRange(r);}}};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){try{var q=o.getSelection();if(!q)return;q.removeAllRanges();}catch(p){}};j.getText=function(o){var p=o.getSelection();if(!p)return;return p.toString();};}else if(h.document.selection){var m=function(o,p,q){var r,s,t,u,v;s=o.createElement('a');r=p.duplicate();r.collapse(q);v=r.parentElement();while(true){v.insertBefore(s,s.previousSibling);r.moveToElementText(s);if(!(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)>0&&(s.previousSibling!=null)))break;}if(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)===-1&&s.nextSibling){r.setEndPoint((q?'EndToStart':'EndToEnd'),p);t=s.nextSibling;u=r.text.length;}else{t=s.parentNode;u=i.getChildIndex(s);}s.parentNode.removeChild(s);return [t,u];},n=function(o,p,q,r,s){var t,u,v,w,x;x=0;t=i.isText(r)?r:r.childNodes[s];u=i.isText(r)?r.parentNode:r;if(i.isText(r))x=s;w=o.createElement('a');u.insertBefore(w,t||null);v=o.body.createTextRange();v.moveToElementText(w);w.parentNode.removeChild(w);p.setEndPoint((q?'StartToStart':'EndToEnd'),v);return p[q?'moveStart':'moveEnd']('character',x);};j.supported=true;j.hasSelection=function(o){var p;if(!o.document.selection)return false;p=o.document.selection.createRange();return p&&p.parentElement().document===o.document;};j.getStart=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,true);};j.getEnd=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,false);};j.isBidirectional=function(o){return false;};j.getOrigin=function(o){return j.getStart(o);};j.getFocus=function(o){return j.getEnd(o);};var l=function(o,p,q,r,s,t){if(s==null)s=q;if(t==null)t=r;var u=p.document.body.createTextRange();n(p.document,u,false,s,t);n(p.document,u,true,q,r);return u.select();};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){return o.document.selection.empty();};j.getText=function(o){if(!j.hasSelection(o))return null;var p=o.document.selection.createRange();return p&&p.text;};}else j.supported=false;}).call(this);f.exports=Selection;},null);
__d('StructuredInputSelection',['DOM','DOMSelection','Scroll','Vector','StructuredInputUtil','StructuredInputDOM'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(p){'use strict';var q=p.ownerDocument;this.window=q.defaultView||q.parentWindow;this.root=p;this.selection=false;this.start=new o(this,[]);this.end=new o(this,[]);this.update();}n.prototype.isSupported=function(){'use strict';return !!(i&&i.hasSelection);};n.prototype.update=function(){'use strict';this.selection=false;if(this.isSupported()&&this.root==document.activeElement)if(i.hasSelection(this.window)){var p=i.getStart(this.window),q=i.getEnd(this.window),r=i.getFocus(this.window);this.start=this.makeMarker(p);this.end=this.makeMarker(q);this.backward=p[0]==r[0]&&p[1]==r[1];this.selection=this.start.node&&this.end.node;}};n.prototype.makeMarker=function(p){'use strict';if(p[0]===this.root){return new o(this,[this.root.childNodes[p[1]],0]);}else return new o(this,p);};n.prototype.getFocus=function(){'use strict';return this.backward?this.start:this.end;};n.prototype.getOrigin=function(){'use strict';return this.backward?this.end:this.start;};n.prototype.move=function(p){'use strict';if(this.selection){this.start.move(p);this.start.snap();this.end.setPosition(this.start);return this.apply();}};n.prototype.expand=function(p){'use strict';if(this.selection){if(i.isBidirectional()){this.start.move(!p);this.start.snap();this.end.move(p);this.end.snap();}return this.apply();}};n.prototype.getText=function(){'use strict';if(this.selection&&this.isSupported()){var p=i.getText(this.window);return p;}};n.prototype.getOffset=function(){'use strict';if(this.selection)return this.start.rootOffset;};n.prototype.getLength=function(){'use strict';return (this.getText()||"").length;};n.prototype.setPosition=function(p,q){'use strict';this.backward=false;this.selection=true;this.start.setPosition(l.getMarkerAtOffset(this.root,p));this.start.snap();if(q>0){this.end.setPosition(l.getMarkerAtOffset(this.root,p+q));this.end.snap();}else this.end.setPosition(this.start);return this.apply();};n.prototype.hasRange=function(){'use strict';return this.selection&&(this.start.node!=this.end.node||this.start.offset!=this.end.offset);};n.prototype.scrollToFocus=function(){'use strict';var p=5,q=this.getFocus();if(q.node){var r=k.getElementDimensions(this.root).x,s=j.getLeft(this.root),t=q.node.offsetLeft+q.node.offsetWidth;if(t-s<p){j.setLeft(this.root,t-p);}else if(t-s>r-p)j.setLeft(this.root,t-r+p);}};n.prototype.apply=function(){'use strict';if(this.start.hasChanged()||this.end.hasChanged()){var p=this.getOrigin().getMarker(true),q=this.getFocus().getMarker(true);this.selection=this.selection&&p&&p.node&&q&&q.node;if(this.selection&&this.isSupported()){this.start.changed=false;this.end.changed=false;i.trySelection(this.window,p.node,p.offset,q.node,q.offset);return true;}}};n.prototype.markDirty=function(p){'use strict';if(h.contains(p,this.start.node,p))this.start.changed=true;if(h.contains(p,this.end.node,p))this.end.changed=true;};function o(p,q){'use strict';this.selection=p;this.node=q[0];this.offset=q[1];this.rootOffset=this.getRootOffset(q[0],q[1]);this.sibling=this.node&&this.node.previousSibling;this.changed=false;}o.prototype.hasChanged=function(){'use strict';return this.changed||!this.isNodeValid();};o.prototype.isNodeValid=function(){'use strict';if(m.getLength(this.node)>this.offset){var p=this.node;while(p=p.parentNode)if(p==this.selection.root)return true;}};o.prototype.getMarker=function(p){'use strict';if(this.isNodeValid()&&(p&&!this.node.firstChild||!p&&this.node.parentNode==this.selection.root)){return this;}else return m.getMarker(this.selection.root,this.rootOffset,p);};o.prototype.move=function(p){'use strict';this.node&&this.setPosition(l.nextMarkerBoundary(this.getMarker(false),p,'select'));};o.prototype.snap=function(){'use strict';this.node&&this.setPosition(l.snapMarkerToText(this.getMarker(false),'select'));};o.prototype.setPosition=function(p){'use strict';if(p.offset!=this.offset||p.node!=this.node){this.changed=true;this.node=p.node;this.offset=p.offset;this.rootOffset=this.getRootOffset(this.node,this.offset);}};o.prototype.getRootOffset=function(p,q){'use strict';var r=0,s=5;while(p&&r++<s)if(p===this.selection.root){return q;}else{var t=p;while(t=t.previousSibling)q+=m.getLength(t);p=p.parentNode;}};f.exports=n;},null);
__d('StructuredInput',['Arbiter','ArbiterMixin','CSS','DOM','DataStore','Event','Input','InputSelection','JSLogger','Keys','Locale','Parent','Scroll','StructuredInputCleaner','StructuredInputDOM','StructuredInputSelection','StructuredInputUtil','Style','UserAgent_DEPRECATED','createArrayFromMixed','createObjectFrom','cx','csx','emptyFunction','fbt','getActiveElement','isElementNode','isTextNode','setTimeoutAcrossTransitions','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka){if(c.__markCompiled)c.__markCompiled();var la,ma,na=229,oa=ba([q.UP,q.DOWN,q.LEFT,q.RIGHT,q.HOME,q.END]),pa=ba([q.BACKSPACE,q.DELETE]),qa=ba([q.SPACE,q.RETURN]),ra=ba('IUB'.split('').map(function(wa){return wa.charCodeAt(0);})),sa=z.firefox(),ta=z.ie(),ua=z.webkit();la=babelHelpers.inherits(va,ka(i));ma=la&&la.prototype;function va(wa){'use strict';ma.constructor.call(this);l.set(wa,'StructuredInput',this);this._root=wa;this._richInput=k.find(wa,"._586i");this._textInput=k.find(wa,"._586f");this._placeholderText=k.scry(wa,"._586j")[0];this._hintText=k.find(wa,"._586k");this._contentWidth=null;this._richWidth=null;this._hintNodes=[];h.subscribe(p.DUMP_EVENT,(function(xa,ya){ya.structuredInputState={initInputsFinished:!!this._initInputsFinished,initEventsFinished:!!this._initEventsFinished,cleanInputPreTogglesFinished:!!this._cleanInputPreTogglesFinished,cleanInputFinished:!!this._cleanInputFinished,elements:{richInput:!!this._richInput,textInput:!!this._textInput,placeholderText:!!this._placeholderText,hintText:!!this._hintText}};}).bind(this));this.init();}va.prototype.init=function(){'use strict';this.init=ea;this._initSelection();this._initCleaner();this._initInputs();this._initInputsFinished=true;this._initEvents();this._initEventsFinished=true;this._scheduledCleanInput=false;this._richChanged=false;this._textChanged=false;this._selectionChanged=false;this._selectionIgnore=false;this._imeMode=false;this.cleanInput();this.inform('init',null,h.BEHAVIOR_PERSISTENT);};va.prototype._initInputs=function(){'use strict';this._richInput.contentEditable=true;this._richInput.spellcheck=false;this._richInput.tabIndex=0;this._richInput.setAttribute('aria-label',fa._("Search Facebook"));this._textInput.tabIndex=-1;this._multiline=this._textInput.nodeName=='TEXTAREA';if(!j.shown(this._richInput)){var wa=o.get(this._textInput),xa=ga()===this._textInput;k.setContent(this._richInput,v.encodeText(n.getValue(this._textInput)));j.hide(this._textInput);j.show(this._richInput);this.cleanInput();if(xa){this._richInput.focus();this.setSelection({offset:wa.start,length:wa.end-wa.start});}}this.togglePlaceholder();this._toggleHint();};va.prototype._initEvents=function(){'use strict';var wa=null,xa=false,ya=(function(){this._richChanged=true;xa||this.scheduleCleanInput(true);}).bind(this),za=(function(){this._textChanged=true;xa||this.scheduleCleanInput(false);}).bind(this),ab=(function(){this._selectionChanged=true;this.scheduleCleanInput(false);}).bind(this),bb=(function(){this._imeMode=true;this._placeholderText&&j.hide(this._placeholderText);j.hide(this._hintText);}).bind(this),cb=(function(){this._imeMode=false;this._richChanged=true;this.cleanInput();}).bind(this);m.listen(this._richInput,'keydown',(function(db){wa=db.keyCode;if(db.ctrlKey&&db.keyCode in ra){return db.kill();}else if(db.keyCode in oa){ab();}else if(db.keyCode===q.BACKSPACE&&this._deleteTrailingChunk()){this._richChanged=true;this.cleanInput();return db.kill();}else if(db.keyCode in pa){ya();}else if(db.keyCode==na)bb();}).bind(this));m.listen(this._richInput,'keypress',(function(db){if(db.keyCode==q.RETURN){this._multiline&&this._insertText("\n");return db.kill();}else if(!this._selectionChanged&&this._selectionIsText()){za();}else ya();}).bind(this));if(!xa){m.listen(this._richInput,'keyup',(function(db){if((this._imeMode||db.keyCode!=wa)&&db.keyCode in qa){cb();return db.kill();}else if(this._imeMode){this._textChanged=true;this.cleanInput();}}).bind(this));if(sa)m.listen(this._richInput,'input',(function(){this._textChanged=true;this.cleanInput();}).bind(this));}else{m.listen(this._richInput,'compositionstart',bb);m.listen(this._richInput,'compositionend',function(){setTimeout(cb,0);});m.listen(this._richInput,'input',(function(){this._textChanged=true;if(!this._imeMode)if(!this._richChanged){this.cleanInput();}else this.scheduleCleanInput();}).bind(this));}m.listen(document,'selectionchange',(function(){if(this._selectionIgnore){this._selectionIgnore=false;}else this._selectionChanged=true;}).bind(this));m.listen(this._richInput,'mousedown',(function(){this._selectionChanged=true;this._selectionLength=0;this._selectionOffset=0;}).bind(this));m.listen(this._richInput,'mouseup',(function(){this._selectionChanged=true;this.scheduleCleanInput();}).bind(this));m.listen(this._richInput,'cut',(function(){this._richChanged=true;this.scheduleCleanInput(false);}).bind(this));m.listen(this._richInput,'paste',(function(db){this._richChanged=true;this.scheduleCleanInput(true);}).bind(this));m.listen(this._richInput,'drop',(function(db){this.focus();this.selectAll();this._insertClipboard(db&&db.dataTransfer);return db.kill();}).bind(this));m.listen(this._richInput,'dragover',function(db){db.dataTransfer.dropEffect='move';db.dataTransfer.effectAllowed='move';return db.kill();});m.listen(this._richInput,'focus',(function(db){this._toggleHint();this.inform('focus');}).bind(this));m.listen(this._richInput,'blur',(function(db){j.hide(this._hintText);this._imeMode=false;this._richChanged=true;this.scheduleCleanInput(false);this.inform('blur');}).bind(this));};va.prototype._initCleaner=function(){'use strict';this._cleaner=new u(this._richInput,this._selection,true);};va.prototype._initSelection=function(){'use strict';this._selection=new w(this._richInput);this._selectionLength=0;this._selectionOffset=0;};va.prototype._insertClipboard=function(wa){'use strict';if(wa&&typeof wa.getData==='function'){var xa=wa.getData('Text');this._insertText(xa);}};va.prototype._deleteTrailingChunk=function(wa){'use strict';var xa=this.getSelection();if(xa.length>0||xa.offset===0)return false;var ya=this.getSelection().offset-1,za=x.getMarkerAtOffset(this._richInput,ya);if(za&&v.isEntityNode(za.node)&&x.getGrouping(za.node,'select')!=='none'){k.remove(za.node);return true;}return false;};va.prototype._selectionIsText=function(){'use strict';var wa=this._selection.start.node,xa=this._selection.end.node;return wa&&wa===xa&&!v.isEntityNode(wa)&&!v.isEntityNode(wa.parentNode);};va.prototype._insertText=function(wa){'use strict';if(wa){var xa=k.create('div',{},wa);return this._insertNodes(xa);}};va.prototype._insertHTML=function(wa){'use strict';if(wa){var xa=k.create('div'),ya=new u(xa,null,false);xa.innerHTML=wa;ya.clean();return this._insertNodes(xa);}};va.prototype._insertNodes=function(wa){'use strict';if(document.selection){document.selection.createRange().pasteHTML(wa.innerHTML);}else document.execCommand('insertHTML',false,wa.innerHTML);this._richChanged=true;this.cleanInput();};va.prototype.togglePlaceholder=function(wa){'use strict';if(!this._placeholderText)return;var xa=v.getLength(this._richInput)===0;if(wa&&xa){j.show(this._placeholderText);}else j.conditionShow(this._placeholderText,xa&&!this._imeMode);};va.prototype._toggleHint=function(){'use strict';var wa=aa(this._hintNodes),xa=null,ya='',za=v.getText(this._richInput).toLowerCase();if(!this.hasFocus())return;if(this._contentOverflows()){j.hide(this._hintText);return;}while(wa.length&&ya.length<za.length){xa=wa.shift();ya+=v.getText(xa);}if(za.length&&ya.substr(0,za.length).toLowerCase()==za.toLowerCase()){k.setContent(this._hintText,aa(this._richInput.cloneNode(true).childNodes).filter(function(bb){return bb.tagName!=='BR';}));var ab=v.createTextNode(ya.substr(za.length));wa.unshift(ab);k.appendContent(this._hintText,k.create('span',{className:"_586h"},wa));j.show(this._hintText);j.hide(this._placeholderText);}else j.hide(this._hintText);};va.prototype._contentOverflows=function(){'use strict';if(this._richWidth===null)this._richWidth=this._richInput.clientWidth;if(this._contentWidth===null){var wa=this._richInput.lastChild;this._contentWidth=ha(wa)?wa.offsetLeft+wa.offsetWidth:0;}return this._contentWidth>this._richWidth;};va.prototype._forceTop=function(){'use strict';if(!this._multiline)t.setTop(this._richInput,0);t.setTop(this._root,0);};va.prototype._createStructureNodes=function(wa){'use strict';return wa.map((function(xa){return xa.uid||xa.type&&xa.type!='text'?v.createEntityNode(xa,xa.display||{}):v.createTextNode(xa.text);}).bind(this));};va.prototype._suppressInput=function(){'use strict';if(sa||ta){if(this._richClean)return;this._richClean=this._richInput.cloneNode(true);this._richClean.contentEditable=false;this._root.insertBefore(this._richClean,this._richInput.nextSibling);t.setLeft(this._richClean,t.getLeft(this._richInput));y.set(this._richInput,'padding',0);y.set(this._richInput,'height',0);}};va.prototype._revealInput=function(){'use strict';if(!this._richClean)return;y.set(this._richInput,'height','');y.set(this._richInput,'padding','');this._root.removeChild(this._richClean);this.focus();this._richClean=null;};va.prototype._cleanInput=function(){'use strict';var wa;if(this._textChanged&&!this._richChanged){this._selection.update();wa='change';}else if(this._richChanged||this._selectionChanged){this._selection.update();if(this._richChanged){this._contentWidth=null;this._cleaner.clean();this._cleaner.endOnText();this._selection.apply();wa='change';}if(this._selectionChanged){this._cleanSelection();if(this._selectionLength||!this._richChanged)wa='select';}}this._revealInput();this._forceTop();this._cleanInputPreTogglesFinished=true;if(this._richChanged||this._textChanged){this.togglePlaceholder();this._toggleHint();}this._selectionIgnore=true;this._selectionChanged=false;this._richChanged=false;this._textChanged=false;this._cleanInputFinished=true;wa&&this.inform(wa);};va.prototype._cleanSelection=function(){'use strict';var wa=this._selection.getLength(),xa=this._selection.getOffset();if(wa){this._selection.expand(wa>=this._selectionLength);wa=this._selection.getLength();xa=this._selection.getOffset();}this._selectionLength=wa;this._selectionOffset=xa;};va.prototype.cleanInput=function(){'use strict';this._scheduledCleanInput||this._cleanInput();};va.prototype.scheduleCleanInput=function(wa){'use strict';wa&&this._suppressInput();if(!this._scheduledCleanInput){this._scheduledCleanInput=true;ja((function(){this._cleanInput();this._scheduledCleanInput=false;}).bind(this),0);}};va.prototype.setEnabled=function(wa){'use strict';this._textInput.disabled=!wa;this._richInput.contentEditable=wa;};va.prototype.getRoot=function(){'use strict';return this._root;};va.prototype.getRichInput=function(){'use strict';return this._richInput;};va.prototype.getEnabled=function(){'use strict';return !this._textInput.disabled;};va.prototype.getText=function(){'use strict';return v.getDecodedText(this._richInput);};va.prototype.setText=function(wa){'use strict';k.setContent(this._richInput,v.createTextNode(wa));this._richChanged=false;this._selectionChanged=false;this.inform('change');};va.prototype.setHint=function(wa){'use strict';this._hintNodes=this._createStructureNodes(wa);this._toggleHint();};va.prototype.getStructure=function(){'use strict';var wa=[];aa(this._richInput.childNodes).forEach((function(xa){var ya=!ia(xa),za=v.getDecodedText(xa);za.length&&wa.push({text:za,uid:ya?xa.getAttribute('data-uid'):null,type:ya&&xa.getAttribute('data-type')||'text'});}).bind(this));return wa;};va.prototype.setStructure=function(wa){'use strict';k.setContent(this._richInput,this._createStructureNodes(wa));this._cleaner.clean();this._cleaner.endOnText();this.togglePlaceholder();this._toggleHint();this._richChanged=false;this._selectionChanged=false;this.inform('change');};va.prototype.getContentDimensions=function(){'use strict';var wa=this._richInput.lastChild;return {width:wa?wa.offsetLeft+wa.offsetWidth:0,height:wa?wa.offsetTop+wa.offsetHeight:0};};va.prototype.getSelection=function(){'use strict';if(this._selection)return {offset:this._selection.getOffset(),length:this._selection.getLength()};};va.prototype.setSelection=function(wa){'use strict';if(this.hasFocus()&&this._selection){this._selection.update();this._selection.setPosition(wa.offset,wa.length);this._selection.scrollToFocus();this._selectionChanged=false;this.inform('select');}};va.prototype.moveSelectionToEnd=function(){'use strict';this.setSelection({length:0,offset:v.getLength(this._richInput)});};va.prototype.isSelectionAtEnd=function(){'use strict';var wa=this.getSelection().offset,xa=v.getLength(this._richInput);return wa>=xa;};va.prototype.selectAll=function(){'use strict';this.setSelection({offset:0,length:v.getLength(this._richInput)});};va.prototype.hasFocus=function(){'use strict';return k.contains(this._root,document.activeElement);};va.prototype.focus=function(){'use strict';this._richInput.focus();};va.prototype.blur=function(){'use strict';var wa={position:'absolute',top:0,width:'1px',height:'1px'};if(r.isRTL()){wa.right='-100px';}else wa.left='-100px';var xa=k.create('input',{type:'text',tabIndex:-1,style:wa});k.appendContent(this._root,xa);var ya=function(){if(this.hasFocus()||ua&&document.activeElement===document.body){xa.focus();xa.blur();}};this.blur=ya;this.blur();};va.getInstance=function(wa){var xa=s.byClass(wa,"_586g");if(!xa)throw new Error('No DOMElement structured input found using '+wa);return l.get(xa,'StructuredInput')||new va(xa);};f.exports=va;},null);
__d('FacebarTypeaheadInput',['ArbiterMixin','csx','DOM','FacebarStructuredText','StructuredInput','Vector','Locale','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q,r={text:{className:"text",group:"all",select:"none"},ent:{className:"entity",group:"all",select:"group"},'ent:hashtag_exact':{className:"entity",group:"hashtag",select:"none"}};function s(u){return Object.assign(u.toStruct(),{display:r[u.getType()]||r[u.getTypePart(0)]});}p=babelHelpers.inherits(t,o(h));q=p&&p.prototype;function t(u){'use strict';q.constructor.call(this);this.root=u;this.input=l.getInstance(u);this.value=null;this.selection={offset:0,length:0};this.resetOnChange=true;this.initEvents();}t.prototype.initEvents=function(){'use strict';var u=(function(v,w){this.inform(v,w);}).bind(this);this.input.subscribe('blur',u);this.input.subscribe('focus',u);this.input.subscribe('change',(function(v,w){if(this.resetOnChange)this.value=null;this.inform('change',w);}).bind(this));};t.prototype.togglePlaceholder=function(u){'use strict';return this.input.togglePlaceholder(u);};t.prototype.focus=function(){'use strict';this.input.focus();};t.prototype.blur=function(){'use strict';this.input.blur();};t.prototype.getElement=function(){'use strict';return this.root;};t.prototype.getRawPlaceholderElement=function(){'use strict';return j.find(this.root,"._586j");};t.prototype.getRawInputElement=function(){'use strict';return j.scry(this.root,"._586i")[0];};t.prototype.getValue=function(){'use strict';if(this.value===null)this.value=k.fromStruct(this.input.getStructure());return this.value;};t.prototype.getLength=function(){'use strict';return this.getValue().getLength();};t.prototype.resetPlaceholder=function(){'use strict';this.input.resetPlaceholder();};t.prototype.setValue=function(u,v){'use strict';this.value=u;this.resetOnChange=!!v;var w=u.toArray().map(s);this.input.setStructure(w);this.input.setSelection({offset:u.getLength(),length:0});this.resetOnChange=true;};t.prototype.storeSelection=function(){'use strict';this.selection=this.input.getSelection();};t.prototype.restoreSelection=function(){'use strict';if(this.selection)this.input.setSelection(this.selection);};t.prototype.clearSelection=function(){'use strict';this.input.setSelection({offset:this.getLength(),length:0});};t.prototype.setHint=function(u){'use strict';var v=u&&!u.hasRTL()&&!n.isRTL()?u.toArray().map(s):[];this.input.setHint(v);};t.prototype.isSelectionAtEnd=function(){'use strict';return this.input.isSelectionAtEnd();};t.prototype.selectInput=function(u){'use strict';this.input.setSelection({offset:u||0,length:this.getLength()});};t.prototype.getEndOffset=function(){'use strict';var u=m.getElementDimensions(this.root),v=this.input.getContentDimensions();return Math.min(u.x,v.width);};Object.assign(t.prototype,{events:['change','focus','blur']});f.exports=t;},null);
__d('FacebarTypeaheadWebSearch',['FacebarStructuredFragment','FacebarStructuredText'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=new h({type:'ent:websuggestion',text:'Web Search: ',uid:null}),k=j.getText().toLowerCase().trim();function l(o,p){if(!o||o.type!=='websuggestion')return;var q=p.getValue().toArray();q.forEach(function(r){if(r.isType('ent')&&!r.isType('ent','user')&&r.getUID())if(o.extra_uri_params){o.extra_uri_params.qh=r.getUID();return;}});}function m(o){return o.getType()===j.getType();}function n(o){'use strict';this._core=o.getCore();this._view=o.getView();this._input=this._core.input;this._isEnabled=false;}n.prototype.enable=function(){'use strict';this._isEnabled=true;this.changeListener=this._input.subscribe('change',this._changeWebSearch.bind(this));this.lockListener=this._input.subscribe('shortcut',this._lockWebSearch.bind(this));this.beforeSelectListener=this._view.subscribe('beforeSelect',this._beforeSelect.bind(this));this.beforeRenderListener=this._view.subscribe('beforeRender',this._beforeRender.bind(this));};n.prototype._changeWebSearch=function(){'use strict';var o=this._input.getValue(),p=o.toArray(),q=p[0];if(q&&q.getType()==='text')if(q.getText().toLowerCase().startsWith(k)){p.splice(0,1,j,new h({text:q.getText().substr(k.length).replace(/^ /,'')}));this._replaceFragments(p);}else if(p.length>1&&p.some(m)){var r='';p.forEach(function(s){if(m(s))return;r+=s.getText();});this._input.storeSelection();this._input.setValue(i.fromString(r));this._input.restoreSelection();}};n.prototype._replaceFragments=function(o){'use strict';this._input.storeSelection();this._input.setValue(new i(o));this._input.restoreSelection();};n.prototype._beforeSelect=function(o,p){'use strict';l(p.selected,this._input);return true;};n.prototype._beforeRender=function(o,p){'use strict';var q=this._input.getValue().toArray()[0],r=q&&m(q);p.results.forEach(function(s){if(s.type==='websuggestion')s.isLockedWebSearchMode=r;});return true;};n.prototype._lockWebSearch=function(o,p){'use strict';if(p.shift){var q=this._input.getValue().toArray()[0];if(!q||!m(q))this._input.setValue(new i([j]));}};n.prototype.disable=function(){'use strict';this.beforeSelectListener.unsubscribe();this.changeListener.unsubscribe();this.lockListener.unsubscribe();this.beforeRenderListener.unsubscribe();this._isEnabled=false;};n.addPrefix=function(o){'use strict';var p=m(o.getFragment(0))||o.getFragment(0).getText().toLowerCase().startsWith(k);if(!p){var q=[j].concat(o.toArray());return new i(q);}else return o;};f.exports=n;},null);
__d('FacebarTypeaheadCore',['Animation','Arbiter','ArbiterMixin','Base64','DOM','Event','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','FacebarTypeaheadInput','FacebarTypeaheadWebSearch','Keys','KeywordsSearchResultConfig','Parent','Style','URI','arrayContains','cx','csx','getActiveElement','invariant','mixin','setTimeout'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){if(c.__markCompiled)c.__markCompiled();var ga,ha;ga=babelHelpers.inherits(ia,ea(j));ha=ga&&ga.prototype;function ia(ja){'use strict';ha.constructor.call(this);Object.assign(this,ja);}ia.prototype.init=function(ja,ka,la){'use strict';if(window.getSelection===null)throw new Error('Facebar: window.getSelection is null!');this.init=function(){};this.data=ja;this.view=ka;this.root=la;this.facebarRoot=w.byClass(la,"_585-");this.windowFocused=true;this.isFocused=false;this.hoverAnimation=null;this.stickyQuery=null;this.settedQuery=null;this.selectedQuery=null;this.currentQuery=null;this.initSubcomponents();this.initEvents();this.checkValue();};ia.prototype.initSubcomponents=function(){'use strict';var ja=l.find(this.root,"._5861");this.input=new s(ja);this.view.setInputElement(this.input.getRawInputElement());};ia.prototype.initEvents=function(){'use strict';m.listen(this.root,'keydown',this.keydown.bind(this));m.listen(this.root,'keyup',this.keyup.bind(this));m.listen(this.root.parentNode,'mousedown',this.mousedown.bind(this));m.listen(this.view.getElement(),'mousedown',this.mousedown.bind(this));m.listen(window,'focus',this.focusWindow.bind(this));m.listen(window,'blur',this.blurWindow.bind(this));this.view.subscribe('select',this.selectView.bind(this));this.view.subscribe('highlight',this.highlightView.bind(this));this.view.subscribe('render',this.highlightView.bind(this));this.view.subscribe('hideHelp',this.performQuery.bind(this));this.input.subscribe('focus',this.focusInput.bind(this));this.input.subscribe('blur',this.blurInput.bind(this));this.input.subscribe('change',this.changeInput.bind(this));this.data.subscribe('activity',this.typeaheadActivity.bind(this));this.data.subscribe('respond',this.completeData.bind(this));this.data.subscribe('nullstateReady',this.performQueryIfVisible.bind(this));i.subscribe('FacebarTypeahead.clearRecentSearches',(function(){return this.clearRecentSearches();}).bind(this));i.subscribe('FacebarTypeahead.focus',(function(){this.input.focus();fa((function(){this.input.clearSelection();}).bind(this),0);}).bind(this));fa(this.initFocus.bind(this),0);};ia.prototype.initFocus=function(){'use strict';if(!this.lazyFocused&&l.contains(this.input.root,ca())){this.lazyFocused=true;this.isFocused=true;this._newSession();this.inform('focus',{catchup:true});this.open(true);}};ia.prototype.setStartTime=function(ja){'use strict';this.inform('focusStartTime',{time:ja});};ia.prototype.cleanQuery=function(ja){'use strict';ja=babelHelpers._extends({},ja)||{};if(!ja.structure)ja.structure=new r();if(!n.allowGrammar||o.nonGrammarTypes[ja.type])ja.structure=r.fromString(ja.structure.toString());!(ja.structure instanceof r)?da(0):undefined;if(ja.type=='websuggestion'&&n.allowGrammar&&n.webSearchLockedInMode)ja.structure=t.addPrefix(ja.structure);return ja;};ia.prototype._unlockQuery=function(){'use strict';var ja=this.input.getValue();if(ja.hasType('ent')&&ja.trim().getCount()===1){this.input.storeSelection();this.input.setValue(r.fromString(ja.toString()));this.input.restoreSelection();}};ia.prototype.setPageQuery=function(ja){'use strict';ja=this.cleanQuery(ja);var ka=this.input.getValue(),la=ja.structure,ma=!la.isEmptyOrWhitespace()&&(ka.isEmptyOrWhitespace()||!ka.matches(la));return this.selectQuery(ja,ma);};ia.prototype.selectQuery=function(ja,ka){'use strict';ka=ka!==false;ja=this.cleanQuery(ja);if(ka||!this.selectedQuery){if(ka||this.getValue().isEmptyOrWhitespace())this.setQuery(ja);this.selectedQuery=ja;}return ja;};ia.prototype.completeSelection=function(){'use strict';var ja=this.view.getSelection();if(ja&&!ja.search){this.data.saveResult(ja);ja.structure=ja.structure.pad();this.setQuery(ja);return true;}};ia.prototype.setQuery=function(ja,ka){'use strict';ja=this.cleanQuery(ja);if(ja.structure.hasType('blank'))ja.structure=new r(ja.structure.toArray().filter(function(la){return la.getType()!='blank';}));this.input.setValue(ja.structure);this.settedQuery=ja;this.stickyQuery=ka===false?this.stickyQuery:ja;this.checkValue();};ia.prototype.checkValue=function(){'use strict';if(this.value&&this.value.getHash()==this.input.getValue().getHash())return;this.checkBlockedSearch();this.performQueryIfVisible();};ia.prototype.checkBlockedSearch=function(){'use strict';var ja=this.input.getValue().toString().toLocaleLowerCase();if(!this.data.blockees||!this.data.blockees.hasOwnProperty(ja)){this.view.hideBlockNotification();}else this.view.showBlockNotification(this.data.blockees[ja]);};ia.prototype.isNullState=function(){'use strict';return this.input.getValue().getHash()==='';};ia.prototype.performQueryIfVisible=function(){'use strict';if(!this.view.visible)return;this.value=this.nextQuery=this.getValue();this.performQuery();};ia.prototype.performQuery=function(){'use strict';if(n.graphSearchV2)this.view.resetIndex();this.data.query(this.nextQuery);this.currentQuery=this.nextQuery;};ia.prototype.requery=function(){'use strict';if(this.currentQuery)this.data.query(this.currentQuery);};ia.prototype.executeQuery=function(ja){'use strict';ja=this.cleanQuery(ja);var ka=this.inform('execute',ja),la=this.getSessionID();this.close();if(n.allowGrammar){this.selectQuery(ja);}else this.selectQuery();if(n.hasRecentSearchNullState&&ja.type!=='shortcut')this.data.resultStore.addRecentEntryToNullState(ja);if(!ka)this._navigateToQuery(ja,la);};ia.prototype.getSearchType=function(){'use strict';return 'facebar';};ia.prototype._newSession=function(){'use strict';if(this._sessionID!=null)return;this._sessionID=Math.random().toString();this.inform('session',this._sessionID,i.BEHAVIOR_STATE);};ia.prototype._closeSession=function(){'use strict';this._sessionID=null;this.inform('session',null,i.BEHAVIOR_STATE);};ia.prototype.getSessionID=function(){'use strict';return this._sessionID;};ia.prototype._navigateToQuery=function(ja,ka){'use strict';var la=this.data.facebarConfig;if(ja.uri){ja.uri.addQueryData(ja.extra_uri_params);ja.uri.addQueryData({ref:'br_tf'});if(ja.structure&&(ja.type=='websuggestion'||ja.type==v.result_type||ja.type=='grammar'&&(!la||String(ja.uri.getPath()).startsWith(la.search_path)))){var ma=this.data.getRawStructure(ja.structure).text_form,na=k.encode(encodeURIComponent(ma)).replace(/\=+$/,''),oa={sid:ka,qs:na,gv:this.data.getQueryData().grammar_version},pa=k.encode(JSON.stringify(oa)).replace(/\=+$/,'');ja.uri.addQueryData({ref:pa,bs:ja.alternateSemantic});}ja.uri.go();return;}};ia.prototype.reset=function(){'use strict';this.selectQuery();this.inform('reset');};ia.prototype.animateInputValue=function(ja,ka,la){'use strict';this.hoverAnimation&&this.hoverAnimation.stop();var ma=new h(ka).from('opacity',1).to('opacity',0).duration(150).ondone((function(){this.input.setValue(la);this.hoverAnimation=na.go();}).bind(this)),na=new h(ja).from('opacity',0).to('opacity',1).duration(150).ondone((function(){this.hoverAnimation=null;x.set(ka,'opacity','');x.set(ja,'opacity','');}).bind(this));x.set(ja,'opacity',0);this.hoverAnimation=ma.go();};ia.prototype.open=function(ja){'use strict';this.inform('open');this.view.show(this.facebarRoot.offsetWidth);this.input.focus({catchup:ja});this.checkValue();if(!this.isFocused){this.isFocused=true;this._newSession();this.inform('focus');}};ia.prototype.close=function(){'use strict';this._closeSession();if(this.inform('close')===false)return;if((!this.value||this.value.isEmptyOrWhitespace())&&this.selectedQuery){this.input.setValue(this.selectedQuery.structure);}else if(this.stickyQuery)this.input.setValue(this.stickyQuery.structure);this.input.blur();this.view.hide();this.view.setAutoSelect(false);this.inform('session',null,i.BEHAVIOR_STATE);if(this.isFocused){this.isFocused=false;fa(this.inform.bind(this,'blur'),0);}};ia.prototype.getElement=function(){'use strict';return this.root;};ia.prototype.getValue=function(){'use strict';return this.input.getValue();};ia.prototype.getText=function(){'use strict';return this.getValue().toString();};ia.prototype.submitQuery=function(ja){'use strict';if(n.graphSearchV2&&this.view.index<0){var ka=this.input.getValue(),la=this.data.getRawStructure(ka);if(la&&!la.is_empty){var ma=!la.raw_text?q.getRawTextFromStructured(ka.toArray()):la.raw_text,na=p.makeFacebarEntry(ma);na.position=ja;this.inform('magSearch',na);this.executeQuery(na);}}else this.view.select();};ia.prototype.keydown=function(event){'use strict';var ja=true,ka=m.getKeyCode(event);switch(ka){case u.ESC:this.close();break;case u.RIGHT:if(!n.disableLockingEntitiesOnRightArrow){ja=this.input.isSelectionAtEnd()&&this.completeSelection();}else ja=false;break;case u.TAB:var la=this.cleanQuery(this.view.getSelection()),ma=la.structure.hasType('blank');if(event.getModifiers().shift||!this.completeSelection()&&!this.loading){this.view.setAutoSelect(false);this.view.hide();ja=false;}else if(!ma&&!n.graphSearchV2)this.tabQueued=true;break;case u.UP:this.view.prev();break;case u.DOWN:this.view.next();break;case u.RETURN:var na=-2;this.submitQuery(na);break;case u.PAGE_UP:this.view.first();break;case 222:var oa=this.input.value.trim();if(!event.getModifiers().shift&&oa.endsOnType('ent'))this.input.setValue(oa);ja=false;break;default:var pa=ka<=46&&ka!==8&&ka!==32,qa=ka>=112&&ka<=126,ra=ka===144||ka===145,sa=ka===91||ka===92||ka===93||ka===224;if(!pa&&!qa&&!ra&&!event.metaKey&&!sa){this.data.setSingleState(false);if(n.autohighlight)this.view.setAutoSelect(true);}this.stickyQuery=null;ja=false;break;}this.input.storeSelection();if(ja)return event.kill();};ia.prototype.keyup=function(event){'use strict';var ja=m.getKeyCode(event),ka=ja<=46&&ja!==8&&ja!==32,la=ja>=112&&ja<=126,ma=ja===144||ja===145,na=ja===91||ja===92||ja===93||ja===224;if(!ka&&!la&&!ma&&!event.metaKey&&!na)if(n.unlockTextOnKeypress)this._unlockQuery();};ia.prototype.mousedown=function(event){'use strict';if(n.autohighlight)this.view.setAutoSelect(true);this.input.storeSelection();if(w.byClass(event.target,"_50c9"))event.preventDefault();};ia.prototype.focusWindow=function(){'use strict';this.windowFocused=true;};ia.prototype.blurWindow=function(){'use strict';this.windowFocused=false;};ia.prototype.selectView=function(ja,ka){'use strict';if(!ka||!ka.selected)return;this.data.setSingleState(true);this.inform('select',ka);var la=this.cleanQuery(ka.selected);this.executeQuery(la);};ia.prototype.highlightView=function(){'use strict';var ja=this.view.getSelection();if(n.graphSearchV2){this.input.setHint(ja?ja.structure:null);}else ja&&this.input.setHint(ja.structure);};ia.prototype.blurInput=function(){'use strict';fa((function(){if(this.windowFocused||y.getRequestURI().getSubdomain()==='apps'){this.input.togglePlaceholder();this.close();}}).bind(this),0);};ia.prototype.changeInput=function(){'use strict';this.inform('change');this.checkValue();this.inform('change_end');};ia.prototype.focusInput=function(){'use strict';this.open();this.input.togglePlaceholder(false);};ia.prototype.updateData=function(){'use strict';this.view.setLoading(this.loading);};ia.prototype.completeData=function(ja,ka){'use strict';this.checkBlockedSearch();if(ka.forceDisplay||this.value&&this.value.matches(ka.value)){var la=n.graphSearchV2?!ka.results.length:!ka.results.length&&!this.loading&&ka.isEmptyResults;this.view.render(ka.value,ka.results,ka.isAsync,la);if(this.tabQueued&&this.completeSelection())delete this.tabQueued;}};ia.prototype.typeaheadActivity=function(ja,ka){'use strict';this.fetching=ka.activity;if(this.loading!==this.fetching){this.loading=this.fetching;this.updateData();}};ia.prototype.getNameTextFromSelected=function(){'use strict';var ja=this.settedQuery&&this.settedQuery.semantic,ka=this.data.facebarConfig&&this.data.facebarConfig.name_functions,la=ja&&ka&&ja.match(/[a-z-]+\([^()]+\)/g);if(la)for(var ma=0;ma<la.length;ma++){var na=la[ma].match(/([a-z-]+)\(([^()]+)\)/);if(na&&z(ka,na[1]))return na[2];}return this.value.toString();};ia.prototype.clearRecentSearches=function(){'use strict';this.data.resultStore.clearRecentSearches();};ia.clearRecentSearches=function(){'use strict';i.inform('FacebarTypeahead.clearRecentSearches');};Object.assign(ia.prototype,{events:['session','focus','select','change','execute','blur','focusStartTime','open']});f.exports=ia;},null);
__d('FacebarTypeaheadRecorder',['clickRefAction','Event','Keys','SearchTypeaheadRecorder','URI','Arbiter','FacebarTimerUtils','FacebarGlobalOptions','FacebarJSConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;q=babelHelpers.inherits(s,k);r=q&&q.prototype;function s(t){'use strict';r.constructor.call(this,t);this.userText="";this.nullStateCandidates=null;this.singleStateCandidates=null;this.queryTimes={};this._sessionDisabled=false;this.type="facebar";this._maxQueryID=0;this._isQueryMatch=true;}s.prototype.initEvents=function(t){'use strict';t.getCore().subscribe('session',(function(u,v){if(v===null){this.sessionEnd();}else this.sessionStart(v);}).bind(this));t.getCore().subscribe('select',(function(u,v){this.recordSelectInfo(v);}).bind(this));t.getCore().subscribe('magSearch',(function(u,v){this.recordMagSearch(v);}).bind(this));t.getCore().input.subscribe('shortcut',(function(u,v){this.recordShortcut(v);}).bind(this));t.getCore().subscribe('quickSelectRedirect',(function(u,v){this.recordQuickSelectInfo(v);}).bind(this));t.getView().subscribe('render',(function(u,v){this.recordRender(v);if(this.allFromNullState){this.nullStateCandidates=this.buildListTypeaheadRecords();}else if(this.allFromSingleState)this.singleStateCandidates=this.buildListTypeaheadRecords();}).bind(this));t.getView().subscribe('show',(function(u,v){if(!this.data.lastNullOrSingleStateFetchStartTime)return;this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}).bind(this));t.getView().subscribe('logPerformanceTiming',(function(u,v){this.performanceTimings[v.field]=v.value;}).bind(this));t.data.subscribe('query',(function(u,v){if(!v.value.isEmpty())this.recordCountStat('num_queries');this.recordAvgStat('num_results_from_cache',v.results.length);this.queryTimes[v.queryId]={send:n.getTimestamp()};}).bind(this));t.data.subscribe('sending_request',(function(u,v){var w=v.data.value;if(!w)return;this.backendQueries.push(w);}).bind(this));t.subscribe('navigation',(function(u,v){if(v&&v.structure){this.recordStat('navigation_input',JSON.stringify(v.structure.toStruct()));this.recordStat('navigation_text',v.structure.toString());}}).bind(this));t.data.subscribe('response_received',(function(u,v,w){if(this.queryTimes[v.queryId]){var x=this.queryTimes[v.queryId];x.recv=n.getTimestamp()-x.send;if(v&&v.payload)x.payload_size=JSON.stringify(v.payload).length;}}).bind(this));t.data.subscribe('remote_query_latency',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.remoteQueryLatencies=v.latencies;}}).bind(this));t.data.subscribe('cache_query_latency',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.cacheQueryLatencies=v.latencies;}}).bind(this));t.data.subscribe('backend_response',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.render=n.getTimestamp()-w.send;if(v.payload.incomplete)w.incomplete=true;w.backendInfo=v.payload.info;if(this.core.scubaInfo)this.logToScuba(v,w,this.core.scubaInfo,v.inputQuery,this.type);}}).bind(this));t.getCore().subscribe('change',(function(u,v){this.userInput(this.core.getText());}).bind(this));t.data.subscribe('remote_query_match',(function(u,v){if(this._maxQueryID<v.queryId){this._maxQueryID=v.queryId;this._isQueryMatch=v.isMatch;}}).bind(this));m.subscribe('BrowseNUX/typing',this.disableThisSession.bind(this));m.subscribe('TestConsole/typing',this.disableThisSession.bind(this));t.subscribe('clear',(function(){this.recordAppendStat('before_clear_queries',this.userText);}).bind(this));i.listen(this.element,'keydown',(function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(i.getKeyCode(event)==j.BACKSPACE){if(!this._backspacing){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.core.getText());}}else this._backspacing=false;}).bind(this));this.core.subscribe('open',(function(u,v){if(v&&v.catchup)return;this.data.lastNullOrSingleStateFetchStartTime=Date.now();}).bind(this));this.core.subscribe('focusStartTime',(function(u,v){this.data.lastNullOrSingleStateFetchStartTime=v.time;}).bind(this));this.data.subscribe('beforeQuery',(function(u,v){if(!this.queryStartTime)this.queryStartTime=[];if(!this.query&&!this.data.lastNullOrSingleStateFetchStartTime)this.data.lastNullOrSingleStateFetchStartTime=Date.now();this.queryStartTime[this.query]=Date.now();}).bind(this));t.subscribe('filter',(function(u,v){this._unsupportedGrammarInfo=this.buildUnsupportedGrammarInfo(v);}).bind(this));t.getCore().subscribe('recordFunction',(function(u,v){this._extraRecorder.push(v);}).bind(this));this.data.subscribe('bootstrapped',(function(u,v){this.recordStat('bootstrap_size',v.size||-1);}).bind(this));};s.prototype._reset=function(t){'use strict';this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};};s.prototype.sessionStart=function(t){'use strict';this._sessionEnded=false;this.data.setQueryData({sid:t});this.recordStat('sid',t);if(!this.stats.session_start_time){this.recordStat('session_start_time',n.getTimestamp());var u=new Date(),v=u.getTimezoneOffset(),w=Date.now()-v*60*1000;this.recordStat('session_start_time_user_timezone',w);}this.recordStat('keypressed',0);this.queryTimes={};};s.prototype.sessionEnd=function(){'use strict';if(this._sessionEnded||this._sessionDisabled){if(this._sessionDisabled){this.reset();this._sessionDisabled=false;this._sessionEnded=true;}return;}this._sessionEnded=true;var t='typed';if(this.allFromNullState){t='nullstate';}else if(this.allFromSingleState)t='singlestate';this.recordStat('last_state',t);this.recordStat('session_end_time',n.getTimestamp());this.recordStat('grammar_version',this.data.getQueryData().grammar_version);this.submit();this.nullStateCandidates=null;this.singleStateCandidates=null;};s.prototype.disableThisSession=function(){'use strict';this._sessionDisabled=true;};s.prototype.userInput=function(t){'use strict';this.userText=t;};s.prototype.buildUnsupportedGrammarInfo=function(t){'use strict';var u=t.results?t.results[0]:null;if(!u||u.results_set_type!=='unimplemented')return null;return {unsupported_grammar:{category:u.error_info.category||'unknown',edge:u.error_info.blamed_edge}};};s.prototype.buildTypeaheadRecord=function(t,u){'use strict';var v=t.rankType||t.render_type||t.type,w=0,x=u;if(typeof t.groupIndex=='number'){w=t.groupIndex;x=t.indexInGroup;}var y={group_index:w,index_in_group:x,cost:t.cost,s_value:t.s_value||0,semantic:t.semantic,text:t.structure.toString(),cache_only:t.cacheOnlyResult?1:0,prefetched:t.isPrefetched?1:0,parse:t.parse,category:t.category,type:v,source:t.bootstrapped,grammar_results_type:(t.results_set_type||'').replace(/[\[\{](.*)[\]\}]/,'$1'),result_from_memcache:t.memcache,dynamic_cost:t.dynamic_cost,is_js_bootstrap_match:t.isJSBootstrapMatch,backend_cost:t.backendCost,bootstrap_cost:t.bootstrapCost,match_type:t.match_type,l_type:t.l_type,vertical_type:t.vertical_type,prefix_match:t.prefix_match,prefix_length:t.prefix_length,index_before_buckets:t.indexBeforeBuckets,bucket_lineage:t.bucketLineage,nullstate:t.isNullState,singlestate:t.isSingleState,query_id:t.qid,template_id:t.templateID,coeff_cost:typeof t.grammar_costs=='undefined'?-1:t.grammar_costs["{"+t.type+"}"],suggestion:t.isSuggestion,keyword_source:t.keywordSource,keyword_bootstrap_type:t.keywordBootstrapType,exact_match_suggestion:t.exactMatchKeyword?1:0};if(t.logInfo)y.backend_log_info=t.logInfo;if(t.s_token)y.s_token=t.s_token;if(t.s_categories)y.s_categories=t.s_categories;return y;};s.prototype.buildListTypeaheadRecords=function(){'use strict';var t=[];this.results&&this.results.forEach((function(u,v){if(u.uid!=='search')t.push(this.buildTypeaheadRecord(u,v));}).bind(this));return t;};s.prototype.recordShortcut=function(t){'use strict';this.recordStat('shortcut',1);this.recordStat('shortcut_with_shift',t.shift);};s.prototype.recordStats=function(t,u){'use strict';for(var v in u)this.recordStat(t+'_'+v,u[v]);};s.prototype.getTypeaheadIndex=function(t,u){'use strict';var v=typeof t.groupIndex=='number'?t.groupIndex+1:0;return u-v;};s.prototype.recordQuickSelectInfo=function(t){'use strict';var u={input_query:t.input_query,semantic:t.semantic,type:t.type,position:t.position,with_mouse:t.with_mouse,text:t.text,quick_select:1};this.recordStats('selected',u);this.recordStat('quick_select',1);};s.prototype.recordMagSearch=function(t){'use strict';var u={};u.text=t.text;u.semantic=t.semantic;u.type=t.type;u.input_query=t.text;u.position=t.position;this.recordStats('selected',u);};s.prototype.recordSelectInfo=function(t){'use strict';var u=t.selected,v=this.getTypeaheadIndex(u,t.index),w={};if(u.uid=='search'){w.selected_search=1;}else{w=this.buildTypeaheadRecord(u);var x=w.type=='friend'?'user':w.type;w.position=v;w[x]=1;}w.with_mouse=t.clicked?1:0;w.quick_select=0;w.input_query=this.userText;w.input_fragments=JSON.stringify(this.core.currentQuery.toStruct());var y=u.dataGT?{gt:JSON.parse(u.dataGT)}:{},z={href:u.path};h('click',z,null,null,y);this.recordStats('selected',w);this.recordAppendStat('selection_history',{selected:w,candidate_results:this.buildListTypeaheadRecords(),timestamp:n.getTimestamp()});var aa={};this._extraRecorder.forEach((function(ba){ba(t,this.results,aa);}).bind(this));this.recordStat('extra_select_info',JSON.stringify(aa));this.recordStat('selected_with_mouse',t.clicked?1:0);};s.prototype._dataToSubmit=function(){'use strict';this.recordStat('max_results',this.data._maxResults);if(this.stats&&this.stats.selected_input_query){this.recordStat('input_query',this.stats.selected_input_query);}else this.recordStat('input_query',this.userText);this.recordStat('uri',new l(window.location.href).toString());if(!this.stats.shortcut){this.recordStat('shortcut',0);this.recordStat('shortcut_with_shift',false);}var t=this.stats;for(var u in this.avgStats){var v=this.avgStats[u];t[u]=v[0]/v[1];}var w={candidate_results:this.buildListTypeaheadRecords(),timestamp:n.getTimestamp(),input_query:this.userText,remote_query_match:this._isQueryMatch};if(this._unsupportedGrammarInfo)Object.assign(w,this._unsupportedGrammarInfo);this.recordAppendStat('suggestions_at_end_of_session',w);if(this.nullStateCandidates)this.recordAppendStat('suggestions_at_nullstate_session',{candidate_results:this.nullStateCandidates});if(this.singleStateCandidates)this.recordAppendStat('suggestions_at_singlestate_session',{candidate_results:this.singleStateCandidates});this.recordAppendStat('query_times',this.queryTimes);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(o.taSessionLoggingSample){var x=[];this.results.forEach(function(z){x.push([z.text||'',z.category||'',z.subtext||'']);});this.recordStat('raw_suggestions_text',x);}if(o.graphSearchV2){this.recordStat('experience_type','gsv2');}else this.recordStat('experience_type','facebar');for(var y in this.appendStats)t[y]=JSON.stringify(this.appendStats[y]);return t;};s.prototype.getDataToSubmit=function(){'use strict';return this._dataToSubmit();};s.prototype.reset=function(){'use strict';return this._reset();};s.prototype.submit=function(){'use strict';if(!this._sessionDisabled)r.submit.call(this);this.view.inform('feedback');this._reset();};Object.assign(s.prototype,{_sessionEnded:true,_extraRecorder:[],_banzaiRoute:'facebar'});f.exports=s;},null);
__d('FacebarTypeaheadV2',['CSS','csx','cx','DOM','Event','Parent'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={init:function(o){this._view=o.getView();this._root=m.byClass(o.getElement(),"_585-");this._button=k.find(this._root,"._4w98");this._core=o.getCore();l.listen(this._button,'click',this.buttonDownAndClick.bind(this));l.listen(this._button,'mousedown',this.buttonDownAndClick.bind(this));l.listen(this._button,'mouseup',this.buttonUp.bind(this));this._core.subscribe('open',this.showButton.bind(this));this._core.subscribe('close',this.hideButton.bind(this));},showButton:function(){h.addClass(this._button,"_4w97");},hideButton:function(){if(h.hasClass(this._button,"_4w97"))h.removeClass(this._button,"_4w97");},buttonDownAndClick:function(event){event.preventDefault();},buttonUp:function(){if(!this._core.isFocused){this._core.focusInput();}else{var o=-1;this._core.submitQuery(o);}}};f.exports=n;},null);
__d('FacebarTypeaheadGrammarItem.react',['React','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o={user:m._("Person")},p=h.createClass({displayName:'FacebarTypeaheadGrammarItem',renderToken:function(){var q=this.props.result.decoration,r=this.props.result.ambiguity,s=r&&r.text,t=q&&q.entity||r&&r.entity;if(this.props.result.isRecent){var u=m._("Recent search");return (h.createElement(j,{text:[u],innerClass:"_53ab"}));}else if(s){return (h.createElement(j,{text:k.text(s)}));}else if(t)return (h.createElement(j,{text:k.textForEntity(t,o),limit:2,leadingMiddot:true}));},getClassName:function(){var q=this.props.result;if(q.isPeopleAndPagesSuggestion)return "_2enu";if(q.tags&&q.tags.displayedSeeMore)return "_10gs";return "_207";},render:function(){var q=this.renderToken(),r=q&&!q.props.leadingMiddot;return (h.createElement(i,babelHelpers._extends({},this.props,{className:n(this.props.className,this.getClassName()),valign:r,token:q})));}});f.exports=p;},null);
__d('FacebarTypeaheadKeywordItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=l.createClass({displayName:'FacebarTypeaheadKeywordItem',render:function(){var q=[n._("Search")];if(this.props.result.isTrending){q.push(n._("Trending"));}else if(this.props.result.type=='related')q=[n._("Related search")];if(h.renderKeywordSnippets){var r=k.textForEntity(this.props.result,{});if(r&&r.length)q=r;}var s=h.renderKeywordSnippets&&r&&r.length>1,t=s&&this.props.result.isLocal,u=s&&this.props.result.isSpecialIntent&&!t,v=this.props.result.isSeeMore,w=v?null:l.createElement(j,{text:q,mainClass:(s?"_4jt7":'')+(t?' '+"_2xfl":'')+(u?' '+"_4pi4":''),innerClass:"_53ab"});return (l.createElement(i,babelHelpers._extends({},this.props,{className:o(this.props.className,(!h.renderKeywordSnippets?"_207":'')+(' '+"_5d77")),token:w,prefix:this.props.result.query_string.toLowerCase(),showSecondaryIcon:h.showKeywordSuggestionPhotos})));}});f.exports=p;},null);
__d('FacebarTypeaheadNodeItem.react',['React','ReactDOM','DOM','isElementNode'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.createClass({displayName:'FacebarTypeaheadNodeItem',render:function(){var m=this.props.result.node;return (h.createElement('li',this.props,!k(m)?m:null));},attachNode:function(m){var n=this.props.result.node;if(k(n))j.setContent(m,n);},componentDidMount:function(){this.attachNode(i.findDOMNode(this));},componentDidUpdate:function(m,n,o){this.attachNode(i.findDOMNode(this));},shouldComponentUpdate:function(m){return this.props.result.node!==m.result.node;}});f.exports=l;},null);
__d('FacebarTypeaheadRecentItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.createClass({displayName:'FacebarTypeaheadRecentItem',render:function(){return (j.createElement(i,babelHelpers._extends({},this.props,{className:l(this.props.className,!h.renderKeywordSnippets?"_207":''),icon:this.renderIcon()})));},renderIcon:function(){var n=this.props.result;if(!h.allowGrammar)return (j.createElement('img',{className:"_20h",src:n.photo}));var o=n.icon_class?j.createElement('span',{className:n.icon_class}):j.createElement('img',{className:"_20h",src:n.photo});return (j.createElement('span',{className:!h.renderKeywordSnippets||n.icon_class&&h.renderKeywordSnippets?"_k83":''},o));}});f.exports=m;},null);
__d('FacebarTypeaheadTrendingItem.react',['FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.createClass({displayName:'FacebarTypeaheadTrendingItem',render:function(){var n=this.props.result.articleTitle||'',o=j.createElement(i,{text:[n],innerClass:"_53ab",leadingMiddot:true});return (j.createElement(h,babelHelpers._extends({},this.props,{className:l(this.props.className,"_207"),token:o,valign:false})));}});f.exports=m;},null);
__d('FacebarTypeaheadList.react',['ARIA','React','ReactDOM','StaticContainer.react','FacebarTypeaheadEntityItem.react','FacebarTypeaheadGrammarItem.react','FacebarTypeaheadKeywordItem.react','FacebarTypeaheadNodeItem.react','FacebarTypeaheadRecentItem.react','FacebarTypeaheadTrendingItem.react','LoadingIndicator.react','FacebarJSConstants','FacebarGlobalOptions','CSS','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=i.PropTypes,y={grammar:m,trending:q,related:n};y[s.browseTypes.keyword]=n;y[s.keywordType]=n;var z=i.createClass({displayName:'FacebarTypeaheadList',propTypes:{results:x.array,onRender:x.func,onSelect:x.func.isRequired,onHighlight:x.func.isRequired,isKeywordList:x.bool},getItemComponentConstructor:function(aa,ba){if(aa.node)return o;if(aa.isRecent)return p;if(aa.results_set_type===s.browseTypes.keyword)return n;if(aa.type&&y[aa.type])return y[aa.type];return l;},renderItem:function(aa,ba){var ca=this.getItemComponentConstructor(aa),da;if(aa.type===s.keywordType){da=aa.query_string+aa.semantic+aa.boldedSubtext+aa.subtext+aa.fromCache+(aa.isSeeMore?'see_more':'')+(aa.keywordBootstrapType?aa.keywordBootstrapType:'');}else{da=aa.semantic||aa.uid||aa.tuid;da=da+aa.isNullState;if(t.facebarUpdateSnippets)da=da+aa.category+aa.subtext;}return (i.createElement(k,{key:da},i.createElement(ca,{result:aa,onClick:this.handleClick.bind(null,aa),onMouseEnter:this.handleMouseEnter.bind(null,aa)})));},renderFooter:function(){var aa="_3su"+(!this.props.loading?' '+"hidden_elem":'');return (i.createElement('li',{className:aa},i.createElement('div',{className:"_21f"},w._("Finding results"),i.createElement(r,{size:'medium',color:'white'}))));},componentDidMount:function(){var aa=j.findDOMNode(this);h.owns(this.props.accessibilityElement,aa);},hasValidRecentSearches:function(){if(!t.hasRecentSearchNullState||!this.props.results)return false;return this.props.results.some(function(aa){return aa.isRecent;});},render:function(){var aa=this.props.results,ba=[];if(aa)aa.forEach(function(ca){ba.push(this.renderItem(ca));},this);return (i.createElement('div',null,i.createElement('ul',{id:'facebar_typeahead_view_list',className:"_21c"+(this.props.isKeywordList?' '+"_2yob":''),'data-click':'Search',role:'listbox'},ba,this.renderFooter())));},handleClick:function(aa,ba){if(u.hasClass(ba.target,"_2d9t"))return;if(!ba.nativeEvent.isMiddleClick()&&!ba.nativeEvent.getModifiers().any){this.props.onSelect(aa);ba.preventDefault();}},handleMouseEnter:function(aa){this.props.onHighlight(aa);},componentDidUpdate:function(aa,ba,ca){this.props.onRender();},shouldComponentUpdate:function(aa){return this.props.loading!==aa.loading||this.props.results!==aa.results;}});f.exports=z;},null);
__d('FacebarTypeaheadView',['Arbiter','CSS','ContextualLayer','DOM','FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarTypeaheadList.react','Parent','React','ReactDOM','ScriptPath','Style','TypeaheadView','performanceNow','csx','cx','fbt','URI','Link.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba,ca,da='unimplemented';ba=babelHelpers.inherits(ea,u);ca=ba&&ba.prototype;function ea(fa,ga){'use strict';ca.constructor.call(this,fa,ga);this.element=fa;this.sid='';this.index=-1;this.warningShown=false;this.autoSelect=false;this.flipCount=0;this.loading=false;this.handleRender=this.handleRender.bind(this);this.handleHighlight=this.handleHighlight.bind(this);this.handleSelect=this.handleSelect.bind(this);this.events=['highlight','render','filter','show'];}ea.prototype.init=function(){'use strict';this.initializeElements();};ea.prototype.initGSV2Elements=function(){'use strict';var fa=this.element;this.contentKeyword=k.find(fa,"._f7s");this.contentEntity=k.find(fa,"._2pda");this.contentRecent=k.find(fa,"._mn8");this.contentSuggestion=k.find(fa,"._2pl-");this.contentAdminedPages=k.find(fa,"._1e-s");this.contentSeeMore=k.find(fa,"._3-xd");this.keywordResultsContainer=k.create('div');this.entityResultsContainer=k.create('div');this.recentSearchContainer=k.create('div');this.seeMoreContainer=k.create('div');this.results=[];this.keywordResults=[];this.entityResults=[];};ea.prototype.initGSV2Construct=function(){'use strict';this.currentKeywordContainer=this.contentKeyword;this.currentEntityContainer=this.contentEntity;this.contentKeyword.appendChild(this.keywordResultsContainer);this.contentEntity.appendChild(this.entityResultsContainer);this.contentRecent.appendChild(this.recentSearchContainer);this.contentSeeMore.appendChild(this.seeMoreContainer);if(this.isNullState()){if(l.hasRecentOnTopNullState){this.resultsContainer.appendChild(this.contentRecent);this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentRecent);this.resultsContainer.appendChild(this.contentEntity);}return;}if(this.entityTop){this.resultsContainer.appendChild(this.contentEntity);this.resultsContainer.appendChild(this.contentKeyword);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}if(!this.isNullState())this.resultsContainer.appendChild(this.contentSeeMore);};ea.prototype.initializeElements=function(){'use strict';var fa=this.element;this.isGSV2=l.graphSearchV2;this.dynamicRank=this.isGSV2;this.fixedBlendingOrder=l.blendingOrderKeywordFirst||l.blendingOrderEntityFirst;this.entityTop=l.blendingOrderEntityFirst&&!l.renderKeywordsFirst;this.content=k.find(fa,"._21r");this.warningNode=k.find(fa,"._553e");this.blockNotificationNode=k.find(fa,"._2hh");this.resultsContainer=k.create('div');if(this.isGSV2)this.initGSV2Elements();};ea.prototype.initializeList=function(){'use strict';this.renderTypeaheadList();this.content.appendChild(this.resultsContainer);if(this.isGSV2)this.initGSV2Construct();};ea.prototype.initializeLayer=function(){'use strict';this.layer=new j({context:p.byClass(this.causalElement,"_585-"),position:'below',causalElement:this.causalElement},this.element);var fa=this.layer.getContentRoot();this.root=k.find(fa,"._50c9");i.addClass(fa,"_5tlx");if(this.isGSV2)i.addClass(fa,"_5xzd");this.wrapper=fa;};ea.prototype.setInputElement=function(fa){'use strict';this.setAccessibilityControlElement(fa);this.causalElement=fa;this.initializeLayer();this.initializeList();};ea.prototype.setAutoSelect=function(fa){'use strict';this.autoSelect=fa;if(this.index===-1&&fa)this.first();};ea.prototype.getIndexOf=function(fa,ga){'use strict';for(var ha=0;ha<ga.length;ha++)if(fa.semantic===ga[ha].semantic&&fa.isSeeMore===ga[ha].isSeeMore)return ha;return -1;};ea.prototype.handleHighlight=function(fa){'use strict';this.highlight(this.getIndexOf(fa,this.results),false);};ea.prototype.handleSelect=function(fa){'use strict';this.handleHighlight(fa);this.select(true);};ea.prototype.show=function(fa){'use strict';if(!this.visible){this.inform('beforeShow',this.layer);t.set(this.wrapper,'minWidth',fa+'px');var ga=ca.show.call(this);this.first();this.layer.show();this.layer.updatePosition();this.inform('show');h.inform('layer_shown',{type:'FacebarTypeahead'});return ga;}};ea.prototype.hide=function(){'use strict';if(this.visible){this.layer.hide();ca.hide.call(this);this.inform('hide');h.inform('layer_hidden',{type:'FacebarTypeahead'});this.flipCount=0;}return this;};ea.prototype.select=function(fa){'use strict';var ga=this.results&&this.results[this.index];if(!ga){this.inform('quickSelect');return;}var ha=this.inform('beforeSelect',{index:this.index,selected:ga});if(ha!==false){s.setClickPointInfo({click:'Search'});ca.select.call(this,fa);}};ea.prototype.doesResultBelongToEntitySection=function(fa){'use strict';switch(fa.type){case m.keywordType:return false;case m.grammarType:return fa.tags&&fa.tags.displayedSeeMore;default:return true;}};ea.prototype.processGSV2Results=function(fa){'use strict';this.keywordResults=[];this.entityResults=[];var ga=[],ha=[],ia=[],ja=fa.some(function(ka){return ka.isSingleState;});fa.forEach((function(ka){if(this.doesResultBelongToEntitySection(ka)){this.entityResults.push(ka);}else if(ja){if(ka.alternateSemantic){ha.push(ka);}else if(ka.exactMatchKeyword){ia.push(ka);}else ga.push(ka);}else this.keywordResults.push(ka);}).bind(this));if(ja)this.keywordResults=ia.concat(ha.concat(ga));if(this.entityTop)return this.entityResults.concat(this.keywordResults);return this.keywordResults.concat(this.entityResults);};ea.prototype.reGenerateContainer=function(){'use strict';var fa=k.create('div');if(this.isNullState()){if(l.hasRecentOnTopNullState){fa.appendChild(this.contentRecent);fa.appendChild(this.currentKeywordContainer);fa.appendChild(this.currentEntityContainer);}else{fa.appendChild(this.currentKeywordContainer);fa.appendChild(this.contentRecent);fa.appendChild(this.currentEntityContainer);}return fa;}if(this.entityTop){fa.appendChild(this.currentEntityContainer);fa.appendChild(this.currentKeywordContainer);}else{fa.appendChild(this.currentKeywordContainer);fa.appendChild(this.currentEntityContainer);}if(!this.isNullState())fa.appendChild(this.contentSeeMore);return fa;};ea.prototype.buildResultsNoRegeneration=function(fa){'use strict';if(this.dynamicRank&&fa.length>0&&!this.fixedBlendingOrder&&!l.renderKeywordsFirst&&this.flipCount<2){var ga=fa[0].type!==m.keywordType;if(l.hasFlipOnce&&this.value.toString()&&this.entityTop!=ga)this.flipCount++;this.entityTop=ga;}var ha=String(this.value);fa.forEach(function(ka){ka.query_string=ha;});this.results=fa;if(this.isGSV2){this.results=this.processGSV2Results(fa);if(this.seeMoreResult){var ia=this.results.indexOf(this.seeMoreResult);if(ia>-1)this.results.splice(ia,1);this.seeMoreResult=null;}this.seeMoreResult=this.inform('seeMore',{value:ha,results:this.results});if(this.seeMoreResult)this.results.push(this.seeMoreResult);}var ja=v();this.renderTypeaheadList({results:this.results,loading:this.loading});this.inform('logPerformanceTiming',{field:'build_results_set_props_duration',value:v()-ja});};ea.prototype.buildResults=function(fa){'use strict';this.buildResultsNoRegeneration(fa);if(this.dynamicRank)this.resultsContainer=this.reGenerateContainer();return this.resultsContainer;};ea.prototype.getGSV2Items=function(){'use strict';return ca.getItems.call(this).filter(function(fa){return !i.hasClass(fa,"_3su");});};ea.prototype.getItems=function(){'use strict';if(this.isGSV2)return this.getGSV2Items();return ca.getItems.call(this).slice(0,-1);};ea.prototype.handleRender=function(){'use strict';this.items=this.getItems();};ea.prototype.render=function(fa,ga,ha,ia){'use strict';this.inform('filter',{results:ga,value:fa});var ja=!fa||fa instanceof n&&fa.isEmptyOrWhitespace();i.conditionClass(this.wrapper,"_5qz2",!ga.length&&ja&&!this.getMegaphone());var ka=ga[0];if(ia&&!ja){if(!this.isGSV2)this.showWarning(y._("There are no results for '{query}'",[y.param('query',fa.toString())]));}else if(ka&&ka.results_set_type===da){if(!ka.error_info.suppress)this.showWarning(ka.error_info.errorMessage||y._("This search isn't currently supported."));}else this.hideWarning();if(this.inform('removeUnimplementedGrammar')!==false)ga=ga.filter((function(la){return la.results_set_type!==da;}).bind(this));ca.render.call(this,fa,ga,ha);};ea.prototype.reset=function(){'use strict';this.index=-1;this.items=[];this.results=[];this.value='';this.buildResults([]);this.inform('reset');return this;};ea.prototype.resetIndex=function(){'use strict';this.index=-1;};ea.prototype.getMegaphone=function(){'use strict';return k.scry(this.element,'.megaphone_location_gsv2_typeahead')[0];};ea.prototype.showBlockNotification=function(fa){'use strict';var ga=new z('https://www.facebook.com').setPath('/settings').addQueryData('tab','blocking'),ha=q.createElement('div',null,y._("You've blocked {fullName}. For more info on privacy and blocking, go to your {settings}.",[y.param('fullName',fa),y.param('settings',q.createElement(aa,{href:{url:ga}},y._("settings")))]));i.show(this.blockNotificationNode);r.render(ha,this.blockNotificationNode);};ea.prototype.hideBlockNotification=function(){'use strict';i.hide(this.blockNotificationNode);k.setContent(this.blockNotificationNode,'');};ea.prototype.showWarning=function(fa){'use strict';i.show(this.warningNode);k.setContent(this.warningNode,fa);this.warningShown=true;this.highlight(-1,false);};ea.prototype.hideWarning=function(){'use strict';i.hide(this.warningNode);this.warningShown=false;this.highlight(this.index,false);};ea.prototype.setLoading=function(fa){'use strict';if(this.loading!=fa){this.loading=fa;this.renderTypeaheadList({results:this.results,loading:fa});}};ea.prototype.first=function(){'use strict';this.index=this.autoSelect?0:-1;this.highlight(this.index);};ea.prototype.prev=function(){'use strict';if(this.isGSV2){if(this.index<0||this.index===0&&this.autoSelect)this.index=this.items.length;}else if(this.index<=0)this.index=this.items.length;this.ignoreMouseover=true;ca.prev.call(this);};ea.prototype.next=function(){'use strict';if(this.isGSV2&&this.autoSelect&&this.index>=this.items.length-1)this.index=-1;if(!this.isGSV2&&this.index+1>=this.items.length)this.index=-1;this.ignoreMouseover=true;ca.next.call(this);};ea.prototype.highlight=function(fa,ga){'use strict';ga=ga!==false&&this.index!=fa;if(!ga||this.inform('beforeHighlight')!==false){var ha=this.warningShown||!this.autoSelect?-1:0;ca.highlight.call(this,Math.max(ha,fa),ga);}};ea.prototype.isNullState=function(){'use strict';return !String(this.value).trim();};ea.prototype.updateCurrentKeywordContainer=function(){'use strict';var fa=this.currentKeywordContainer;if(this.isNullState()){this.currentKeywordContainer=this.contentSuggestion;}else this.currentKeywordContainer=this.contentKeyword;if(fa&&fa!==this.currentKeywordContainer){i.hide(fa);fa.removeChild(this.keywordResultsContainer);this.currentKeywordContainer.appendChild(this.keywordResultsContainer);}};ea.prototype.updateCurrentEntityContainer=function(){'use strict';var fa=this.currentEntityContainer,ga=!String(this.value).trim();if(ga&&this.entityResults){this.currentEntityContainer=this.contentAdminedPages;}else this.currentEntityContainer=this.contentEntity;if(fa&&fa!=this.currentEntityContainer){i.hide(fa);fa.removeChild(this.entityResultsContainer);this.currentEntityContainer.appendChild(this.entityResultsContainer);}};ea.prototype.hasValidRecentSearches=function(){'use strict';if(!l.hasRecentSearchNullState||!this.keywordResults)return false;return this.keywordResults.some(function(fa){return fa.isRecent;});};ea.prototype.copyProps=function(fa){'use strict';return babelHelpers._extends({accessibilityElement:this.accessibilityElement,onRender:this.handleRender,onHighlight:this.handleHighlight,onSelect:this.handleSelect},fa);};ea.prototype.renderList=function(fa,ga){'use strict';r.render(q.createElement(o,this.copyProps(fa)),ga);};ea.prototype.renderGSV2TypeaheadList=function(fa){'use strict';var ga=this.copyProps(Object.assign({},fa,{isKeywordList:true})),ha=this.copyProps(fa),ia=this.copyProps(Object.assign({},fa,{isKeywordList:true}));ga.results=this.isNullState()?this.keywordResults.filter(function(la){return !la.isRecent;}):this.keywordResults;ia.results=this.isNullState()?[]:this.results.filter(function(la){return la.isSeeMore;});ha.results=this.entityResults;if(ia.results.length>0){ga.loading=false;ha.loading=false;}else if(this.entityTop||ha.results.length===0){ha.loading=false;}else ga.loading=false;var ja=!!ga.results.length;this.renderList(ga,this.keywordResultsContainer);this.renderList(ha,this.entityResultsContainer);var ka=false;if(this.isNullState()){ga.results=this.keywordResults.filter(function(la){return la.isRecent;});this.renderList(ga,this.recentSearchContainer);ka=!!ga.results.length;}this.updateCurrentKeywordContainer();this.updateCurrentEntityContainer();this.renderList(ia,this.seeMoreContainer);i.conditionShow(this.currentKeywordContainer,ja);i.conditionShow(this.contentRecent,ka);i.conditionShow(this.currentEntityContainer,!!this.entityResults.length);i.conditionClass(this.element,"_3gbv",l.typeaheadkeywordStyle==='relaxed');i.conditionClass(this.element,"_3gbw",l.typeaheadkeywordStyle==='baggy');i.conditionShow(this.contentSeeMore,this.seeMoreResult!=null&&!this.isNullState());};ea.prototype.renderTypeaheadList=function(fa){'use strict';fa=fa||{};if(this.isGSV2){this.renderGSV2TypeaheadList(fa);}else this.renderList(fa,this.resultsContainer);};f.exports=ea;},null);
__d('DismissNUXOnFocus',['Arbiter','NavigationMessage','Run','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){'use strict';this.view=m.getCore().view;this.subscriptionsHandler=new k();}l.prototype.enable=function(){'use strict';this.subscriptionsHandler.addSubscriptions(h.subscribe(i.NAVIGATION_BEGIN,(function(){this.disable();}).bind(this)));j.onLeave((function(){this.disable();}).bind(this));this.setup();};l.prototype.disable=function(){'use strict';this.teardown();};l.prototype.setup=function(){'use strict';this.subscriptionsHandler.addSubscriptions(this.view.subscribe('show',this.onViewShow.bind(this)));};l.prototype.teardown=function(){'use strict';this.subscriptionsHandler.release();};l.prototype.onViewShow=function(){'use strict';h.inform('SearchAwareness.weakDismissUnit');};f.exports=l;},null);
__d('FacebarTypeaheadDisambiguateResults',['FacebarDisambiguationDialog','FacebarStructuredFragment','FacebarStructuredText','URI','emptyFunction','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(w,x){var y={};w.forEach(function(ba){if(ba.type=='grammar'){var ca=x(ba.structure).toLowerCase();y[ca]=y[ca]||[];y[ca].push(ba);}});var z=[];for(var aa in y)if(y[aa].length>1)z.push(y[aa]);return z;}function o(w){var x=[];w.toArray().forEach(function(y,z){if(y.isType('ent'))x.push(z);});return x;}function p(w,x,y){var z={},aa={},ba={};x.forEach(function(da){var ea=w[0].structure.getFragment(da),fa=ea.getHash();aa[fa]=aa[fa]||[];ba[da]=aa[fa];w.forEach(function(ga){var ha=ga.structure.getFragment(da),ia=ha&&ha.getUID();if(ia&&!z.hasOwnProperty(ia)){aa[fa].push(y.getEntryForFragment(ha));z[ia]=true;}});});for(var ca in ba)if(ba[ca].length<=1)delete ba[ca];return ba;}function q(w,x){var y={},z=[];w.forEach(function(aa){var ba=aa.structure.getFragment(x).getUID();if(!y.hasOwnProperty(ba)){y[ba]=z.length;z.push([]);}z[y[ba]].push(aa);});return z;}function r(w,x,y){var z=w.shift();z.ambiguity.entities=x;y.push.apply(y,w);return z;}function s(w,x){var y=[],z=[],aa=false;w.forEach(function(ca){ca.ambiguity={fragment:null,entities:null,text:null};});n(w,function(ca){return ca.getHash();}).forEach(function(ca){var da=ca[0].structure,ea=o(da),fa=p(ca,ea,x);if(aa){r(ca,fa,y);return;}var ga=ea.pop();if(typeof ga=='number'){var ha=q(ca,ga);aa=ha.length>1;if(aa)delete fa[ga];ha.forEach(function(ia){var ja=r(ia,fa,y);if(aa){var ka=ja.structure.getFragment(ga).getUID();ja.ambiguity.entity=x.getEntry(ka);z.push(ja);}});}});y.forEach(function(ca){var da=w.indexOf(ca);da!=-1&&w.splice(da,1);});n(w,function(ca){return ca.toString();}).forEach(function(ca){ca.forEach(function(da){if(!da.ambiguity.entities)da.ambiguity.text=da.queryTypeText;});});var ba=w.indexOf(z[0]);z.slice(1).forEach(function(ca){var da=w.indexOf(ca);if(da!=-1&&da!=++ba){w.splice(da,1);w.splice(ba,0,ca);}});}function t(w,x){var y=w&&w.ambiguity&&w.ambiguity.entities,z=y&&Object.keys(y).map(Number),aa=x.core.input;if(!z||z.length===0)return false;var ba=function(ea){x.core.executeQuery(u(w,z,ea));},ca=function(){aa.focus();aa.input.moveSelectionToEnd();};y=y?m(y):[];var da=new h(y,w.uri.getPath(),ba,ca,x.getCore().getSessionID());aa.blur();da.show();return true;}function u(w,x,y){var z=w.structure.toArray(),aa=new k(w.uri),ba=aa.getPath().split('/');x.forEach(function(ca){var da=z[ca],ea=y.shift(),fa=ba.indexOf(String(da.getUID()));if(fa!=-1)ba[fa]=ea.uid;z[ca]=new i({uid:ea.uid,text:ea.text,type:'ent:'+ea.type});});return {uri:aa.setPath(ba.join('/')),structure:new j(z)};}function v(w){'use strict';this._typeahead=w;}v.prototype.enable=function(){'use strict';this._typeahead.view.subscribe('filter',(function(w,x){s(x.results,this._typeahead.data);}).bind(this));this._typeahead.view.subscribe('beforeSelect',(function(w,x){return !t(x.selected,this._typeahead);}).bind(this));};Object.assign(v.prototype,{disable:l});f.exports=v;},null);
__d("XBrowseWarmUserRequestArgsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/browse\/warm\/requestargs\/",{});},null);
__d('FacebarTypeaheadEarlyUserRequest',['AsyncRequest','XBrowseWarmUserRequestArgsController'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._core=k.getCore();this._listener=null;}j.prototype.enable=function(){'use strict';this._listener=this._core.subscribe('focus',(function(k,l){new h().setURI(i.getURIBuilder().getURI()).send();this.disable();}).bind(this));};j.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=j;},null);
__d('FacebarTypeaheadNavigation',['Arbiter','FacebarNavigation','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l){'use strict';this._core=l.core;this._preserveQuery=false;this._typeahead=l;}k.prototype.enable=function(){'use strict';i.registerBehavior(this);this._core.subscribe('execute',this.executedUserQuery.bind(this));};k.prototype.executedUserQuery=function(l,m){'use strict';this._preserveQuery=true;};k.prototype.pageTransition=function(){'use strict';if(!this._preserveQuery){this._core.close();this._core.reset();}else this._preserveQuery=false;};k.prototype.setPageQuery=function(l){'use strict';l=this._core.setPageQuery(l);this._typeahead.inform('navigation',l,h.BEHAVIOR_PERSISTENT);};Object.assign(k.prototype,{disable:j});f.exports=k;},null);
__d('FacebarTypeaheadPrefixLengthOrderedCache',['emptyFunction','Arbiter'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._typeahead=k;}j.prototype.enable=function(){'use strict';this._typeahead.data.inform('setSortFunction',function(k,l){if(k.cache_id_length!==l.cache_id_length)return k.cache_id_length-l.cache_id_length;var m=(k.cost||0)-(l.cost||0);if(m!==0)return m;return (k.semantic||'').localeCompare(l.semantic||'');},i.BEHAVIOR_STATE);};Object.assign(j.prototype,{disable:h});f.exports=j;},null);
__d('FacebarTypeaheadQuickSelect',['FacebarStructuredText','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='/search/web/direct_search.php';function k(l){'use strict';this._core=l.getCore();this._view=l.getView();this._input=this._core.input;this._beforeSelectListener=null;this._quickSelectListener=null;}k.prototype.enable=function(){'use strict';this._beforeSelectListener=this._view.subscribe('beforeSelect',this._quickSelect.bind(this));this._quickSelectListener=this._view.subscribe('quickSelect',this._quickSelect.bind(this));};k.prototype._quickSelect=function(l,m){'use strict';if(m&&m.selected)return true;var n=this._input.getValue().toArray(),o=new h(n),p=o.toString();if(!p)return true;var q=new i(j).addQueryData('q',p),r={input_query:p,type:'quickselect',text:p,position:0,with_mouse:0,semantic:'quickselect('+q.toString()+')',extra_uri_params:{source:'quickselect',sid:this._core.getSessionID()},uri:q};this._core.inform('quickSelectRedirect',r);this._core.executeQuery(r);return false;};k.prototype.disable=function(){'use strict';this._beforeSelectListener&&this._view.unsubscribe(this._beforeSelectListener);this._quickSelectListener&&this._view.unsubscribe(this._quickSelectListener);};f.exports=k;},null);
__d('FacebarTypeaheadRecorderBasic',['FacebarTypeaheadRecorder'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._typeahead=j;}i.prototype.enable=function(){'use strict';var j=this._typeahead;this._recorder=new h(j);};i.prototype.disable=function(){'use strict';this._typeahead.unsubscribe(this._subscription);this._recorder=null;this._subscription=null;};Object.assign(i.prototype,{_subscription:null});f.exports=i;},null);
__d('FacebarTypeaheadSeeMore',['FacebarGSv2Echo','FacebarKeywordSearchUtils','FacebarStructuredText','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n){'use strict';this.$FacebarTypeaheadSeeMore1=n.getCore();this.$FacebarTypeaheadSeeMore2=this.$FacebarTypeaheadSeeMore1.view;}m.prototype.enable=function(){'use strict';this.$FacebarTypeaheadSeeMore3=this.$FacebarTypeaheadSeeMore2.subscribe('seeMore',this.$FacebarTypeaheadSeeMore4.bind(this));};m.prototype.disable=function(){'use strict';this.$FacebarTypeaheadSeeMore3.unsubscribe();};m.prototype.$FacebarTypeaheadSeeMore4=function(n,o){'use strict';var p=o.value.toString().trim();p=h.normalizeValue(p);var q=i.makeFacebarEntry(p),r=l._("See all results for \"{query}\"",[l.param('query',p)]);return babelHelpers._extends({},q,{query_string:p,icon_class:"_5b1w",isSeeMore:true,structure:j.fromString(p),displayStructure:j.fromString(String(r)),uri:q.uri,tags:{}});};f.exports=m;},null);
__d('FacebarTypeaheadSelectAll',['requestAnimationFrame'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._core=j.getCore();this._listener=null;}i.prototype.enable=function(){'use strict';var j=this._core.input;this._listener=this._core.subscribe('focus',function(k,l){var m=l&&l.catchup;m||h(function(){j.selectInput();});});};i.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=i;},null);
__d('FacebarTypeaheadSizeAdjuster',['getElementChildren','clamp','emptyFunction','isTextNode','Style','Vector'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=12,o=20,p=50,q=200,r=5;function s(u){if(k(u))return 0;return m.getElementDimensions(u).x;}function t(u){'use strict';this._core=u.getCore();this._view=this._core.view;this._input=this._core.input;this._cachedSizes={};this._appliedSize=null;this._defaultSize=this.getDefaultFontSize();this._calculatedSize=this._defaultSize;this._containerWidth=this.getContainerWidth();}t.prototype.enable=function(){'use strict';this._input.subscribe('change',this.adjustFontSize.bind(this));this.adjustFontSize();};t.prototype.getContainerWidth=function(){'use strict';return m.getElementDimensions(this._input.getElement()).x;};t.prototype.getDefaultFontSize=function(){'use strict';var u=l.get(this._input.getElement(),'font-size'),v=/^([\d\.]+)px$/.exec(u),w=v&&Number(v[1]);return Math.max(n,Math.min(o,w));};t.prototype.calculateFontSize=function(){'use strict';var u=this.getTextWidth(),v=this._calculatedSize;if(u>this._containerWidth-p){v--;}else if(u<this._containerWidth-q)v++;this._calculatedSize=i(v,n,this._defaultSize);return this._calculatedSize;};t.prototype.getTextWidth=function(){'use strict';var u=this._calculatedSize+this.getValueKey();if(!this._cachedSizes.hasOwnProperty(u))this._cachedSizes[u]=this.measureTextWidth();return this._cachedSizes[u];};t.prototype.getValueKey=function(){'use strict';var u=this._core.getValue().getHash(),v=r*Math.floor(u.length/r);return u.substr(0,v);};t.prototype.measureTextWidth=function(){'use strict';var u=h(this._input.getRawInputElement());return u.reduce(function(v,w){return v+s(w);},0);};t.prototype.adjustFontSize=function(){'use strict';for(var u=0;u<10;u++){var v=this.calculateFontSize();if(v!=this._appliedSize){this._appliedSize=v;l.set(this._input.getElement(),'font-size',v+'px');l.set(this._view.content,'font-size',v+'px');}else break;}};Object.assign(t.prototype,{disable:j});f.exports=t;},null);
__d('SearchAwarenessLearningNUX',['Arbiter','CSS','DOM','NavigationMessage','Run','SearchAwarenessDispatcher','SearchAwarenessWebConfig','SearchPivotType','SubscriptionsHandler','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();function s(t){'use strict';this.core=t.getCore();this.view=this.core.view;this.data=this.core.data;this.debug=false;this.subscriptionsHandler=new p();this.showingFirstStep=true;this.setupComplete=false;this.setupSecondStepComplete=false;}s.prototype.enable=function(){'use strict';var t=this.core.getValue()!=null?this.core.getValue().toString():null;if(t==null||t.length>0&&!this.data.getSingleState())return;this.subscriptionsHandler.addSubscriptions(h.subscribe('SearchAwareness.triggerLearningNUX',(function(u,v){if(v.origin===o.LEARNING_NUX){this.setup();}else this.setupSecondStep();}).bind(this)),h.subscribe(k.NAVIGATION_BEGIN,(function(){this.disable();}).bind(this)));l.onLeave((function(){this.disable();}).bind(this));this.setup();};s.prototype.disable=function(){'use strict';this.teardown();};s.prototype.setup=function(){'use strict';if(this.setupComplete)return;var t=this.getHiddenAwarenessUnit(o.LEARNING_NUX),u=this.core.getValue()!=null?this.core.getValue().toString():null;if(t==null||u==null||u.length>0&&!this.data.getSingleState())return;this.config=JSON.parse(t.getAttribute('data-config'));if(this.config.ghost_text!=null){var v=j.scry(document.body,"._586i")[0];if(v){i.addClass(v,"_55me");v.setAttribute('data-ghost-text',this.config.ghost_text);}}this.firstStep=j.create('div',{'class':"_1qs6"},t);j.prependContent(this.view.getElement(),this.firstStep);this.subscriptionsHandler.addSubscriptions(this.view.subscribe('show',this.onViewShow.bind(this)),this.view.subscribe('hide',this.onViewHide.bind(this)),this.view.subscribe('filter',this.onViewFilter.bind(this)),this.view.subscribe('beforeSelect',this.onViewBeforeSelect.bind(this)));this.mask=j.create('div',{className:"_3lif"});j.appendContent(document.body,this.mask);this.showSecondStepAwarenessUnit();this.activationWindowTimer=setTimeout((function(){this.disable();}).bind(this),this.config.activation_window);this.setupComplete=true;};s.prototype.teardown=function(){'use strict';if(this.mask)i.removeClass(this.mask,"_3lih");i.removeClass(this.view.getElement(),"_3lii");i.removeClass(this.view.getElement(),"_1qs7");i.removeClass(this.view.getElement(),"_55mf");i.removeClass(this.view.getElement(),"_55mg");i.removeClass(this.core.getElement(),"_55mh");if(this.debug)return;if(this.mask){j.remove(this.mask);this.mask=null;}if(this.firstStep){j.remove(this.firstStep);this.firstStep=null;}if(this.secondStep){j.remove(this.secondStep);this.secondStep=null;}this.subscriptionsHandler.release();};s.prototype.setupSecondStep=function(){'use strict';if(this.setupSecondStepComplete||!this.setupComplete)return;var t=this.getHiddenAwarenessUnit(o.LEARNING_NUX_SECOND_STEP);if(t==null){this.setupSecondStepComplete=true;return;}this.secondStep=j.create('div',{className:"_3lig"},t);j.prependContent(this.view.getElement(),this.secondStep);this.setupSecondStepComplete=true;};s.prototype.getHiddenAwarenessUnit=function(t){'use strict';var u=j.scry(document.body,"._3lik"),v=undefined;for(var w=u,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z,ba=aa.getAttribute('data-origin');if(ba===t&&aa.firstChild!=null)v=aa;}if(v==null)return undefined;var ca=v.firstChild;j.remove(v);return ca;};s.prototype.onViewShow=function(){'use strict';this.showOrHideFirstStep();clearTimeout(this.activationWindowTimer);i.addClass(this.mask,"_3lih");i.addClass(this.view.getElement(),"_3lii");};s.prototype.onViewHide=function(){'use strict';this.disable();};s.prototype.onViewFilter=function(t,u){'use strict';this.showOrHideFirstStep();var v=0;for(var w=0;w<u.results.length;w++){var x=u.results[w];if(x.type==='keyword'){v++;var y=x.uri.getQueryData();y[n.url_param_trigger_key]=this.config.aw_id;x.uri.setQueryData(y);}else x.unselectable=true;}var z=this.core.getValue()!=null?this.core.getValue().toString():null,aa=z!=null&&z.length>0&&z.length<3&&v<3;i.conditionClass(this.core.getElement(),"_55mh",aa);if((this.config.block_ta_entity_clicks==null||this.config.block_ta_entity_clicks===false)&&z!=null&&z.length>=1)i.addClass(this.view.getElement(),"_55mf");};s.prototype.onViewBeforeSelect=function(t,u){'use strict';if(this.blockedClick||this.config.block_ta_entity_clicks!==true)return true;if(u.selected.type!=='keyword'){this.blockedClick=true;i.addClass(this.view.getElement(),"_55mf");i.addClass(this.view.getElement(),"_55mg");setTimeout((function(){i.removeClass(this.view.getElement(),"_55mg");}).bind(this),5000);return false;}return true;};s.prototype.showSecondStepAwarenessUnit=function(){'use strict';m.triggerLearningNUX(o.LEARNING_NUX_SECOND_STEP,this.config.encoded_query,this.config.actor_id,this.config.story_id,this.config.global_share_id);};s.prototype.showOrHideFirstStep=function(){'use strict';i.conditionClass(this.view.getElement(),"_1qs7",this.core.isNullState()||this.data.getSingleState());};f.exports=s;},null);
__d('TypeaheadSearchMegaphone',['AsyncRequest','DOM','DOMQuery','Event','Parent'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n){'use strict';this.$TypeaheadSearchMegaphone1=n;}m.prototype.enable=function(){'use strict';var n=j.scry(this.$TypeaheadSearchMegaphone1.getView().getElement(),'.megaphone_location_gsv2_typeahead')[0];if(!n)return;this.ajaxify=j.scry(n,'a.megaphone_hide_link[ajaxify]')[0].getAttribute('ajaxify');j.scry(n,'a').forEach(this.processLink,this);k.listen(n,'click',this.onClick.bind(this));};m.prototype.disable=function(){'use strict';};m.prototype.processLink=function(n){'use strict';if(n.getAttribute('ajaxify'))return;i.setAttributes(n,{target:'_blank'});};m.prototype.onClick=function(event){'use strict';var n=l.byTag(event.target,'a');if(!n||n.getAttribute('ajaxify'))return;h.bootstrap(this.ajaxify,n);};f.exports=m;},null);